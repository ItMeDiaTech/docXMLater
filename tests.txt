PASS tests/core/Document.insertValidation.test.ts (10.326 s)
  Document Insert Validation
    insertParagraphAt()
      âˆš should reject non-Paragraph types (150 ms)
      âˆš should reject null (3 ms)
      âˆš should reject undefined (5 ms)
      âˆš should accept valid Paragraph instance (4 ms)
      âˆš should detect duplicate paragraph IDs (15 ms)
      âˆš should allow paragraphs with different IDs (9 ms)
      âˆš should warn about missing styles (4 ms)
      âˆš should warn about missing numbering (2 ms)
      âˆš should normalize negative index to 0 (3 ms)
      âˆš should normalize index beyond length to end (3 ms)
    insertTableAt()
      âˆš should reject non-Table types (2 ms)
      âˆš should reject null (3 ms)
      âˆš should accept valid Table instance (2 ms)
      âˆš should reject table with zero rows (2 ms)
      âˆš should reject table with empty rows (2 ms)
      âˆš should warn about missing table styles (7 ms)
      âˆš should normalize negative index to 0 (2 ms)
    insertTocAt()
      âˆš should reject non-TableOfContentsElement types (5 ms)
      âˆš should reject null (3 ms)
      âˆš should accept valid TableOfContentsElement instance (2 ms)
      âˆš should not throw when inserting TOC (2 ms)
    replaceParagraphAt()
      âˆš should reject non-Paragraph replacement types (2 ms)
      âˆš should validate replacement paragraph (2 ms)
      âˆš should accept valid replacement (3 ms)
      âˆš should return false if index out of bounds (2 ms)
      âˆš should return false if element is not a paragraph (2 ms)
    replaceTableAt()
      âˆš should reject non-Table replacement types (2 ms)
      âˆš should validate replacement table (5 ms)
      âˆš should accept valid replacement (2 ms)
      âˆš should return false if index out of bounds (2 ms)
      âˆš should return false if element is not a table (2 ms)
    Integration Tests
      âˆš should allow multiple inserts with validation (4 ms)
      âˆš should maintain document integrity through save/load cycle (121 ms)

PASS tests/validation/TextElementProtection.test.ts (10.43 s)
  Text Element Protection (from Error Analysis Report)
    Issue #1: Self-Closing Text Element Protection
      âˆš should throw error if w:t is marked as self-closing (30 ms)
      âˆš should never create self-closing w:t elements (1 ms)
      âˆš should preserve empty text with proper closing tag (1 ms)
    Issue #2: Run Text Validation
      âˆš should warn when creating run with undefined text (5 ms)
      âˆš should warn when creating run with null text (1 ms)
      âˆš should convert undefined/null text to empty string (1 ms)
    Issue #8: Run Helper Methods
      âˆš should correctly identify runs with text (1 ms)
      âˆš should correctly identify runs with formatting (1 ms)
      âˆš should validate runs correctly
    Round-Trip Text Preservation
      âˆš should preserve text through load-save cycle (137 ms)
      âˆš should preserve special characters through round-trip (41 ms)
      âˆš should preserve formatted text through round-trip (48 ms)
      âˆš should detect multiple round-trips without data loss (107 ms)

PASS tests/core/HyperlinkParsing.test.ts (10.564 s)
  Hyperlink Parsing
    External Hyperlinks
      âˆš should parse external hyperlink with URL (87 ms)
      âˆš should parse hyperlink with tooltip (13 ms)
      âˆš should parse hyperlink with formatted text (9 ms)
      âˆš should handle multiple hyperlinks in one paragraph (12 ms)
    Internal Hyperlinks (Anchors)
      âˆš should parse internal hyperlink with anchor (10 ms)
      âˆš should parse internal hyperlink with tooltip (9 ms)
    Edge Cases
      âˆš should handle hyperlink with empty text (improved fallback) (7 ms)
      âˆš should handle hyperlink with missing relationship (7 ms)
      âˆš should handle hyperlink with special characters in text (8 ms)
    Round-Trip Fidelity
      âˆš should preserve hyperlinks through load-save-load cycle (46 ms)
      âˆš should preserve internal hyperlinks through round-trip (21 ms)
    Validation (ECMA-376 Compliance)
      âˆš should throw error if external link toXML() called without relationship ID (67 ms)
      âˆš should NOT throw error if external link has relationship ID set
      âˆš should throw error if hyperlink has neither url nor anchor (2 ms)
      âˆš should NOT throw error for internal links without relationship ID (1 ms)
      âˆš should warn when hyperlink has both url and anchor (hybrid link) (3 ms)
      âˆš should properly escape special characters in tooltip attribute (1 ms)
      âˆš should use correct text fallback chain (text â†’ url â†’ "Link") - anchor should NEVER be display text (1 ms)
      âˆš should preserve validation through Document.save() workflow (17 ms)
    Hyperlink URL Updates
      âˆš should update hyperlink URL using setUrl() (1 ms)
      âˆš should clear relationship ID when URL is updated (7 ms)
      âˆš should update multiple hyperlinks in document using updateHyperlinkUrls() (3 ms)
      âˆš should skip internal hyperlinks when updating URLs (10 ms)
      âˆš should re-register relationships after URL update on save (23 ms)
      âˆš should return 0 when no URLs match the map (2 ms)
      âˆš should handle updating same URL multiple times in one document (4 ms)
    External URL + Anchor Fragment Combination
      âˆš should combine external URL with anchor fragment during parsing (13 ms)
      âˆš should allow docid pattern to be extracted from combined URL (11 ms)
      âˆš should handle multiple hyperlinks with different URL+anchor combinations (22 ms)
      âˆš should preserve combined URL through round-trip save/load (32 ms)
      âˆš should handle getFullUrl() for manually created hyperlinks with both url and anchor (1 ms)
      âˆš should return url from getFullUrl() when no anchor is set
      âˆš should return undefined from getFullUrl() for internal-only links (1 ms)
    TOC Corruption Prevention (Anchor as Display Text Bug)
      âˆš should NOT use anchor bookmark ID as display text when text is empty (8 ms)
      âˆš should preserve TOC-like hyperlinks with proper display text through round-trip (23 ms)
      âˆš should warn when parsing hyperlink with anchor but no display text (8 ms)
  Hyperlinks in Tables (processHyperlinks fix)
    External hyperlinks with URL+anchor in table cells
      âˆš should preserve hyperlinks in table cells through round-trip save/load (28 ms)
      âˆš should handle hyperlinks in table cells without anchor (simple external URL) (48 ms)
      âˆš should register relationship IDs for hyperlinks created via API in table cells (43 ms)
    Multiple hyperlinks in nested table structures
      âˆš should handle multiple hyperlinks across multiple table cells (16 ms)

PASS tests/core/TextPreservation.test.ts (10.532 s)
  Text Preservation
    âˆš should preserve text through save and load cycle (127 ms)
    âˆš should preserve text with XML entities (46 ms)
    âˆš should preserve unicode and special characters (43 ms)
    âˆš should preserve whitespace and newlines (50 ms)
    âˆš should handle empty paragraphs correctly (34 ms)
    âˆš should warn when loading corrupted documents (5 ms)
    âˆš should warn when saving documents with mostly empty content (36 ms)
    âˆš should handle multiple save/load cycles without data loss (171 ms)

PASS tests/elements/TablePropertiesBatch1.test.ts (10.887 s)
  Table Properties Batch 1 - Table-Level Properties
    Table Positioning (tblpPr)
      âˆš should set and serialize absolute positioning (143 ms)
      âˆš should set and serialize relative positioning with alignment (48 ms)
      âˆš should set and serialize positioning with text distances (41 ms)
    Table Overlap (tblOverlap)
      âˆš should set and serialize overlap=true (20 ms)
      âˆš should set and serialize overlap=false (17 ms)
    Bidirectional Visual Layout (bidiVisual)
      âˆš should set and serialize bidiVisual=true (19 ms)
      âˆš should handle undefined bidiVisual (default LTR)
    Table Grid (Column Widths)
      âˆš should set and serialize table grid with custom widths (18 ms)
      âˆš should handle varying column widths (19 ms)
    Accessibility Properties
      âˆš should set and serialize table caption (17 ms)
      âˆš should set and serialize table description (89 ms)
      âˆš should set and serialize both caption and description (62 ms)
    Width and Spacing Types
      âˆš should set and serialize table width with type (29 ms)
      âˆš should set and serialize cell spacing with type (51 ms)
      âˆš should default to 'dxa' for width type (25 ms)
    Combined Properties
      âˆš should handle multiple properties together (35 ms)
      âˆš should preserve properties through multiple save/load cycles (152 ms)
    XML Structure Validation
      âˆš should generate correct XML for positioning (1 ms)
      âˆš should generate correct XML for overlap (1 ms)
      âˆš should generate correct XML for bidiVisual
      âˆš should generate correct XML for caption and description (1 ms)

PASS tests/elements/TablePropertiesBatch3.test.ts (10.968 s)
  Phase 4.3 Batch 3 - Table Row Properties Part 1
    Row Justification (w:jc)
      âˆš should set row justification to center (120 ms)
      âˆš should set row justification to right (51 ms)
      âˆš should preserve multiple row justifications in round-trip (43 ms)
    Hidden Row (w:hidden)
      âˆš should set row as hidden (53 ms)
      âˆš should preserve hidden flag in round-trip (41 ms)
    Grid Before (w:gridBefore)
      âˆš should set gridBefore to skip columns (57 ms)
      âˆš should preserve gridBefore in round-trip (58 ms)
    Grid After (w:gridAfter)
      âˆš should set gridAfter to leave columns (32 ms)
      âˆš should preserve gridAfter in round-trip (59 ms)
    Grid Before + Grid After Combined
      âˆš should handle both gridBefore and gridAfter (35 ms)
      âˆš should preserve gridBefore and gridAfter in round-trip (55 ms)
    Existing Properties Verification
      âˆš should verify cantSplit property works correctly (44 ms)
      âˆš should verify isHeader property works correctly (62 ms)
      âˆš should verify trHeight property works correctly (52 ms)
    Combined Properties
      âˆš should handle multiple row properties together (53 ms)
      âˆš should preserve all properties in multi-cycle round-trip (63 ms)
    Edge Cases
      âˆš should handle row with no properties (30 ms)
      âˆš should handle gridBefore and gridAfter with value 0 (73 ms)
      âˆš should handle all justification values (87 ms)

  console.log
      â±ï¸  100-page document created in 238ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:49:13)

  console.log
      â±ï¸  1000 paragraphs created in 60ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:78:13)

  console.log
      â±ï¸  Load and save completed in 85ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:105:13)

PASS tests/elements/TablePropertyExceptions.test.ts
  Table Property Exceptions (tblPrEx)
    Border Exceptions
      âˆš should set border exceptions for a single row (80 ms)
      âˆš should override different border styles per row (38 ms)
    Shading Exceptions
      âˆš should set shading exception for a row (64 ms)
      âˆš should preserve different shading colors per row (104 ms)
    Combined Exceptions
      âˆš should set borders and shading together (56 ms)
      âˆš should set all property types together (41 ms)
    Cell Spacing Exception
      âˆš should override cell spacing for specific row (52 ms)
    Width and Indentation Exceptions
      âˆš should override width for specific row (87 ms)
    Justification Exception
      âˆš should override justification for specific rows (45 ms)
    Round-Trip Preservation
      âˆš should preserve exceptions through multiple save-load cycles (44 ms)
    Edge Cases
      âˆš should handle row without exceptions (47 ms)
      âˆš should handle empty exceptions object (39 ms)

  console.log
      ğŸ’¾ Memory growth: -38.25MB

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:141:13)

  console.log
      â±ï¸  Formatted document created in 63ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:180:13)

PASS tests/core/Document.test.ts (11.795 s)
  Document
    Document.create()
      âˆš should create a new empty document (15 ms)
      âˆš should create document with properties (4 ms)
      âˆš should initialize required DOCX files (3 ms)
    Paragraph management
      âˆš should add paragraphs (5 ms)
      âˆš should support method chaining for addParagraph (3 ms)
      âˆš should create and add paragraph with text (4 ms)
      âˆš should create empty paragraph when no text provided (1 ms)
      âˆš should get paragraphs as copy (4 ms)
      âˆš should clear all paragraphs (3 ms)
      âˆš should support method chaining for clearParagraphs (6 ms)
    Document properties
      âˆš should set properties (2 ms)
      âˆš should merge properties (2 ms)
      âˆš should support method chaining for setProperties (1 ms)
      âˆš should get properties as copy (9 ms)
      âˆš should handle special characters in properties (2 ms)
    save()
      âˆš should save document to file (68 ms)
      âˆš should save document with multiple paragraphs (42 ms)
      âˆš should save document with formatted paragraphs (27 ms)
      âˆš should update document.xml when saving (26 ms)
    toBuffer()
      âˆš should generate document as buffer (22 ms)
      âˆš should be able to load buffer back (43 ms)
    Document.load()
      âˆš should load document from file (61 ms)
      âˆš should throw error for invalid file (115 ms)
    Document.loadFromBuffer()
      âˆš should load document from buffer (23 ms)
      âˆš should throw error for invalid buffer (178 ms)
    XML generation
      âˆš should generate valid [Content_Types].xml (3 ms)
      âˆš should generate valid _rels/.rels (2 ms)
      âˆš should generate valid core.xml (2 ms)
      âˆš should generate valid app.xml (5 ms)
      âˆš should escape special characters in properties (3 ms)
    Integration tests
      âˆš should create a complete valid DOCX file (30 ms)
      âˆš should handle documents with many paragraphs (20 ms)
      âˆš should create round-trip compatible documents (49 ms)
      âˆš should preserve element order when loading and saving documents (55 ms)
    Parsing documents with conflicting paragraph properties
      âˆš should resolve pageBreakBefore + keepNext conflict during parsing (14 ms)
      âˆš should preserve keepNext/keepLines when pageBreakBefore is not set (18 ms)
      âˆš should handle multiple paragraphs with mixed conflict scenarios (15 ms)
      âˆš should resolve conflicts when properties come from XML with non-standard order (15 ms)
    TOC Field Instruction Parsing
      parseTOCFieldInstruction()
        âˆš should parse TOC field with double-quoted o switch (1 ms)
        âˆš should parse TOC field with single-quoted o switch (3 ms)
        âˆš should parse TOC field with unquoted o switch (1 ms)
        âˆš should extract correct outline levels from double-quoted format (1 ms)
        âˆš should extract correct outline levels from single-quoted format (1 ms)
        âˆš should extract correct outline levels from unquoted format
        âˆš should handle multiple spaces before unquoted o value (1 ms)
        âˆš should not match non-TOC field instructions
        âˆš should handle complex TOC instructions with multiple switches (1 ms)
        âˆš should handle complex TOC instructions with unquoted o switch
    Bookmark Helpers
      addTopBookmark()
        âˆš should create _top bookmark when it does not exist (2 ms)
        âˆš should return existing _top bookmark when already present (2 ms)
        âˆš should place bookmark at the beginning of document (2 ms)
        âˆš should create working hyperlinks to _top bookmark (2 ms)
        âˆš should be idempotent - safe to call multiple times on empty document (3 ms)
        âˆš should be idempotent - safe to call multiple times on document with content (5 ms)
        âˆš should preserve _top bookmark through save/load cycle (33 ms)
        âˆš should generate correct XML structure (12 ms)
        âˆš should work with hyperlinks in other paragraphs (54 ms)
    Preserve Blank Lines After Heading 2 Tables
      applyStyles with preserveBlankLinesAfterHeading2Tables
        âˆš should mark blank lines as preserved when option is true (12 ms)
        âˆš should not mark blank lines as preserved when option is false (11 ms)
        âˆš should default to true when option is not specified (20 ms)
      removeExtraBlankParagraphs
        âˆš should not remove preserved blank paragraphs (11 ms)
        âˆš should not remove paragraphs with text inside revisions (11 ms)
    Revision Registration
      âˆš should register parsed revisions with RevisionManager after loading (31 ms)
      âˆš should make ChangelogGenerator work with parsed revisions (338 ms)
    addBlankLineAfterLists()
      âˆš should add blank line after a simple numbered list (5 ms)
      âˆš should add blank line after a bullet list (10 ms)
      âˆš should handle nested lists as one list (same numId) (1 ms)
      âˆš should add blank line after each separate list (different numIds) (3 ms)
      âˆš should add blank line when list is at end of document (4 ms)
      âˆš should add blank line between list and table (2 ms)
      âˆš should return 0 for document with no lists (2 ms)
      âˆš should return 0 for empty document (5 ms)
      âˆš should not add blank line if one already exists after list (2 ms)
      âˆš should be idempotent - calling twice should not add duplicate blanks (2 ms)
      âˆš should remove blank line in MIDDLE of a list via addStructureBlankLines (5 ms)
      âˆš should add blank line above paragraph starting with bold text and colon (3 ms)
      âˆš should add blank line above paragraph with bold date followed by colon (10 ms)
      âˆš should NOT add blank line above non-bold text with colon (4 ms)
      âˆš should NOT add blank line above bold text without colon (6 ms)
      âˆš should mark existing blank as preserved when blank already exists above bold+colon (5 ms)
      âˆš should respect aboveBoldColon: false option (4 ms)
      âˆš should detect colon anywhere in first 55 characters (5 ms)
      âˆš should NOT detect colon beyond first 55 characters (3 ms)
      âˆš should add blank above bold+colon paragraph in table cell (4 ms)
      âˆš should NOT add blank above bold+colon paragraph if first in table cell (2 ms)
    acceptRevisions load option
      âˆš should accept all revisions when acceptRevisions: true (27 ms)
      âˆš should preserve revisions when acceptRevisions: false or unset (19 ms)
      âˆš should allow subsequent modifications after acceptRevisions: true (41 ms)
      âˆš should handle documents without revisions when acceptRevisions: true (14 ms)
      âˆš acceptRevisions: true should take precedence over revisionHandling: preserve (27 ms)

PASS tests/zip/ZipHandler.test.ts
  ZipHandler
    File Operations
      âˆš should add a file to the archive (8 ms)
      âˆš should add binary file to the archive (11 ms)
      âˆš should update existing file (6 ms)
      âˆš should return false when updating non-existent file (25 ms)
      âˆš should remove a file (14 ms)
      âˆš should return false when removing non-existent file (1 ms)
      âˆš should get all files (3 ms)
      âˆš should get file paths (4 ms)
      âˆš should get file count (13 ms)
      âˆš should normalize file paths (3 ms)
    Validation
      âˆš should validate DOCX structure (4 ms)
      âˆš should throw error when missing required files (89 ms)
    Save and Load
      âˆš should save to file (12 ms)
      âˆš should save to buffer (51 ms)
      âˆš should load from file (67 ms)
      âˆš should load from buffer (6 ms)
      âˆš should handle save with validation disabled (3 ms)
      âˆš should throw error when loading invalid ZIP (7 ms)
    Utility Methods
      âˆš should clear all files (2 ms)
      âˆš should clone handler (1 ms)
      âˆš should track mode correctly (2 ms)
    Static Methods
      âˆš should create new DOCX with static create method (39 ms)
      âˆš should modify existing DOCX with static modify method (71 ms)
    Helper Methods
      File Operations
        âˆš should rename file (5 ms)
        âˆš should return false when renaming non-existent file (2 ms)
        âˆš should copy file (2 ms)
        âˆš should return false when copying non-existent file (4 ms)
        âˆš should move file (2 ms)
        âˆš should return false when moving non-existent file (2 ms)
        âˆš should not throw when file exists (3 ms)
        âˆš should throw when file does not exist (1 ms)
      Batch Operations
        âˆš should remove multiple files (9 ms)
        âˆš should handle non-existent files in batch remove (2 ms)
        âˆš should get files by extension (1 ms)
        âˆš should handle case-insensitive extension search (2 ms)
      Archive Information
        âˆš should get total size (5 ms)
        âˆš should return zero for empty archive (2 ms)
        âˆš should get comprehensive stats (5 ms)
        âˆš should handle empty archive stats (1 ms)
        âˆš should check if archive is empty (2 ms)
      Content Helpers
        âˆš should get text files (1 ms)
        âˆš should get binary files (1 ms)
        âˆš should get media files (3 ms)
      Import/Export
        âˆš should export file (3 ms)
        âˆš should throw when exporting non-existent file (24 ms)
        âˆš should import file (39 ms)
        âˆš should import binary file (12 ms)
    Edge Cases
      âˆš should handle empty file content (2 ms)
      âˆš should handle large file content (16 ms)
      âˆš should handle unicode content (6 ms)
      âˆš should handle files with special characters in path
    UTF-8 Encoding
      âˆš should preserve UTF-8 characters when adding string content (14 ms)
      âˆš should convert string to UTF-8 Buffer internally (2 ms)
      âˆš should handle emoji and special characters (8 ms)
      âˆš should handle mixed scripts (Latin, Greek, Cyrillic, Arabic, CJK) (4 ms)
      âˆš should handle right-to-left text (Arabic, Hebrew) (1 ms)
      âˆš should preserve UTF-8 in XML files (1 ms)
      âˆš should round-trip UTF-8 content (add, retrieve, verify) (2 ms)
      âˆš should handle UTF-8 with line breaks and whitespace (3 ms)
      âˆš should handle Buffer containing valid UTF-8 (1 ms)
      âˆš should preserve UTF-8 when saving and loading from file (19 ms)
      âˆš should preserve complex UTF-8 sequences (5 ms)

  console.log
      â±ï¸  5 concurrent documents created in 107ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:207:13)

  console.log
    
      ğŸ“Š Performance SLA Metrics:

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:240:15)

  console.log
         Document: 1000 paragraphs

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:241:15)

  console.log
         Duration: 52ms

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:242:15)

  console.log
         Throughput: 19231 paragraphs/sec

      at Object.<anonymous> (tests/performance/benchmarks.test.ts:243:15)

PASS tests/performance/benchmarks.test.ts
  Performance Benchmarks
    âˆš should create 100-page document in < 5 seconds (368 ms)
    âˆš should create document with 1000 paragraphs in < 2 seconds (74 ms)
    âˆš should load and re-save document in < 1 second (119 ms)
    âˆš should handle 500 paragraphs without excessive memory growth (103 ms)
    âˆš should create highly formatted document in < 3 seconds (65 ms)
    âˆš should handle concurrent document creation (109 ms)
  Performance Regression Detection
    âˆš should meet performance SLA for typical document (65 ms)

PASS tests/core/DocumentProperties.test.ts
  Phase 5.5 - Document Properties (Extended)
    Core Properties Extensions
      âˆš should set and retrieve category (81 ms)
      âˆš should set and retrieve content status (52 ms)
      âˆš should set and retrieve language (124 ms)
      âˆš should handle multiple core properties (101 ms)
    Extended Properties (App Properties)
      âˆš should set and retrieve application name (82 ms)
      âˆš should set and retrieve app version (55 ms)
      âˆš should set and retrieve company name (85 ms)
      âˆš should set and retrieve manager name (29 ms)
      âˆš should handle multiple extended properties (26 ms)
    Custom Properties
      âˆš should set and retrieve string custom property (52 ms)
      âˆš should set and retrieve number custom property (28 ms)
      âˆš should set and retrieve boolean custom property (66 ms)
      âˆš should set and retrieve date custom property (47 ms)
      âˆš should set multiple custom properties at once (43 ms)
      âˆš should handle custom properties with special characters (32 ms)
    Combined Properties Test
      âˆš should handle all property types together (18 ms)
    Fluent API Chaining
      âˆš should support method chaining for all property setters (14 ms)

PASS tests/elements/TablePropertiesBatch2.test.ts
  Table Properties Batch 2 - Cell-Level Properties
    Text Direction (textDirection)
      âˆš should set and serialize tbRl (top-to-bottom, right-to-left) (77 ms)
      âˆš should set and serialize lrTb (left-to-right, top-to-bottom) (93 ms)
      âˆš should preserve textDirection through round-trip (57 ms)
    Fit Text (tcFitText)
      âˆš should set and serialize fitText property (224 ms)
      âˆš should preserve fitText through round-trip (29 ms)
    No Wrap (noWrap)
      âˆš should set and serialize noWrap property (58 ms)
      âˆš should preserve noWrap through round-trip (43 ms)
    Hide Mark (hideMark)
      âˆš should set and serialize hideMark property (65 ms)
      âˆš should preserve hideMark through round-trip (51 ms)
    Conditional Style (cnfStyle)
      âˆš should set and serialize cnfStyle property (24 ms)
      âˆš should preserve cnfStyle through round-trip (47 ms)
    Width Type (tcW type)
      âˆš should set and serialize auto width type (55 ms)
      âˆš should set and serialize percentage width type (17 ms)
      âˆš should preserve width types through round-trip (27 ms)
    Vertical Merge (vMerge)
      âˆš should set and serialize restart vMerge (17 ms)
      âˆš should set and serialize continue vMerge (19 ms)
      âˆš should handle multi-row vertical merge scenario (37 ms)
    Combined Properties
      âˆš should handle multiple cell properties together (24 ms)
      âˆš should preserve all properties through multi-cycle round-trip (227 ms)

PASS tests/elements/SectionPropertiesEnhanced.test.ts
  Section Properties - Phase 4.5 Enhancements
    Vertical Alignment
      âˆš should set and serialize vertical alignment = top (91 ms)
      âˆš should set and serialize vertical alignment = center (18 ms)
      âˆš should set and serialize vertical alignment = bottom (21 ms)
      âˆš should set and serialize vertical alignment = both (justified) (18 ms)
    Paper Source
      âˆš should set and serialize first page tray (32 ms)
      âˆš should set and serialize other pages tray (21 ms)
      âˆš should set and serialize both first and other trays (45 ms)
    Column Separator
      âˆš should set and serialize column separator line (enabled) (38 ms)
      âˆš should set and serialize column separator line (disabled) (28 ms)
    Custom Column Widths
      âˆš should set and serialize custom column widths (34 ms)
      âˆš should set unequal columns with separator (17 ms)
    Text Direction
      âˆš should set and serialize text direction = ltr (24 ms)
      âˆš should set and serialize text direction = rtl (16 ms)
      âˆš should set and serialize text direction = tbRl (top-to-bottom, right-to-left) (15 ms)
      âˆš should set and serialize text direction = btLr (bottom-to-top, left-to-right) (45 ms)
    Combined Properties
      âˆš should handle all new properties together (47 ms)
      âˆš should preserve new properties with existing properties (167 ms)
      âˆš should preserve all properties through multiple save/load cycles (144 ms)
    Edge Cases
      âˆš should handle section without new properties (13 ms)
      âˆš should handle column separator without custom widths (64 ms)

PASS tests/elements/TableCellProperties.test.ts
  Table Cell Properties - Round Trip Tests
    Cell Margins
      âˆš should round-trip cell with all margins (53 ms)
      âˆš should round-trip cell with top and bottom margins only (101 ms)
      âˆš should round-trip cell with uniform margins (46 ms)
      âˆš should save margins to file and load correctly (24 ms)
    Cell Borders
      âˆš should round-trip cell with borders (17 ms)
    Cell Shading
      âˆš should round-trip cell with shading (31 ms)
    Cell Vertical Alignment
      âˆš should round-trip cell with vertical alignment (54 ms)
    Cell Width
      âˆš should round-trip cell with width (66 ms)
    Column Span
      âˆš should round-trip cell with column span (15 ms)
    Combined Cell Properties
      âˆš should round-trip cell with all properties (96 ms)
      âˆš should save complete formatted table and load correctly (111 ms)
    Professional Table Example
      âˆš should create and load professional table with cell margins (74 ms)

PASS tests/elements/RunAdvancedProperties.test.ts
  Run Advanced Properties - Round Trip Tests
    RTL (Right-to-Left)
      âˆš should set RTL text direction (4 ms)
      âˆš should round-trip RTL property (80 ms)
    Vanish (Hidden Text)
      âˆš should set vanish property
      âˆš should round-trip vanish property (27 ms)
    NoProof (Skip Spellcheck)
      âˆš should set noProof property
      âˆš should round-trip noProof property (78 ms)
    SnapToGrid
      âˆš should set snapToGrid property
      âˆš should round-trip snapToGrid property (54 ms)
    SpecVanish (Special Hidden)
      âˆš should set specVanish property (2 ms)
      âˆš should round-trip specVanish property (70 ms)
    Text Effect
      âˆš should set text effect (1 ms)
      âˆš should round-trip text effect (37 ms)
    FitText
      âˆš should set fitText width (1 ms)
      âˆš should round-trip fitText property (91 ms)
    EastAsianLayout
      âˆš should set East Asian layout with vertical text (1 ms)
      âˆš should set East Asian layout with combine
      âˆš should round-trip East Asian layout (76 ms)
    Combined Properties
      âˆš should support method chaining with all properties (4 ms)

PASS tests/formatting/StylesRoundTrip.test.ts
  Style Round-Trip Tests
    Style Name Parsing
      âˆš should correctly parse style name from self-closing w:name tag (79 ms)
      âˆš should preserve style name with spaces through round-trip (43 ms)
    Created Styles
      âˆš should preserve colors in programmatically created styles (78 ms)
      âˆš should handle black color (000000) without converting to 0 (66 ms)
    Contextual Spacing (List Paragraph)
      âˆš should preserve contextualSpacing in programmatically created styles (97 ms)
      âˆš should preserve contextualSpacing through multiple round-trips (122 ms)
      âˆš should NOT have contextualSpacing when not set (66 ms)

PASS tests/elements/ParagraphCriticalProperties.test.ts
  Paragraph - Critical Properties (Batch 1)
    widowControl
      âˆš should set and serialize widowControl=true (57 ms)
      âˆš should set and serialize widowControl=false (32 ms)
      âˆš should handle undefined widowControl (18 ms)
    outlineLevel
      âˆš should set and serialize outlineLevel=0 (highest level) (18 ms)
      âˆš should set and serialize outlineLevel=5 (mid-level) (17 ms)
      âˆš should set and serialize outlineLevel=9 (lowest level) (12 ms)
      âˆš should reject outline level < 0 (102 ms)
      âˆš should reject outline level > 9 (1 ms)
    suppressLineNumbers
      âˆš should set and serialize suppressLineNumbers=true (13 ms)
      âˆš should handle default suppressLineNumbers (27 ms)
    bidi
      âˆš should set and serialize bidi=true (RTL layout) (37 ms)
      âˆš should set and serialize bidi=false (LTR layout) (24 ms)
      âˆš should handle mixed LTR and RTL text (26 ms)
    textDirection
      âˆš should set and serialize textDirection=lrTb (left-to-right, top-to-bottom) (20 ms)
      âˆš should set and serialize textDirection=tbRl (vertical text) (19 ms)
      âˆš should set and serialize textDirection=btLr (Mongolian) (24 ms)
      âˆš should handle all text direction values (23 ms)
    textAlignment
      âˆš should set and serialize textAlignment=top (24 ms)
      âˆš should set and serialize textAlignment=center (18 ms)
      âˆš should handle all text alignment values (23 ms)
    mirrorIndents
      âˆš should set and serialize mirrorIndents=true (37 ms)
      âˆš should handle default mirrorIndents (33 ms)
    adjustRightInd
      âˆš should set and serialize adjustRightInd=true (26 ms)
      âˆš should set and serialize adjustRightInd=false (24 ms)
    combined properties
      âˆš should handle multiple critical properties together (26 ms)
      âˆš should preserve all properties across multiple save/load cycles (42 ms)

PASS tests/elements/ParagraphMarkProperties.test.ts
  Paragraph Mark Run Properties
    Basic Formatting
      âˆš should set and serialize bold paragraph mark (119 ms)
      âˆš should set and serialize colored paragraph mark (75 ms)
      âˆš should set and serialize font for paragraph mark (19 ms)
    Advanced Formatting
      âˆš should set and serialize multiple paragraph mark properties (24 ms)
      âˆš should set and serialize hidden paragraph mark (59 ms)
      âˆš should set and serialize highlighted paragraph mark (89 ms)
    Complex Script Support
      âˆš should set and serialize complex script formatting for paragraph mark (87 ms)
    XML Generation
      âˆš should generate correct XML structure for paragraph mark properties (1 ms)
      âˆš should not generate empty rPr when no paragraph mark properties set (3 ms)
    Round-trip Verification
      âˆš should preserve paragraph mark properties through multiple save/load cycles (141 ms)
      âˆš should handle paragraphs with both run and paragraph mark properties (58 ms)
    Edge Cases
      âˆš should handle undefined paragraph mark properties gracefully (1 ms)
      âˆš should overwrite previous paragraph mark properties (23 ms)

PASS tests/elements/ParagraphTextBoxProperties.test.ts
  Paragraph - Text Box & Advanced Properties (Batch 3)
    framePr (Text Frame Properties)
      âˆš should set and serialize basic frame properties (w, h, hRule) (48 ms)
      âˆš should set and serialize positioning properties (x, y, anchors) (15 ms)
      âˆš should set and serialize drop cap properties (13 ms)
      âˆš should set and serialize all frame properties combined (38 ms)
      âˆš should handle undefined framePr (54 ms)
    suppressAutoHyphens
      âˆš should set and serialize suppressAutoHyphens=true (26 ms)
      âˆš should handle default (undefined) suppressAutoHyphens (27 ms)
    suppressOverlap
      âˆš should set and serialize suppressOverlap=true (31 ms)
      âˆš should handle default (undefined) suppressOverlap (17 ms)
    textboxTightWrap
      âˆš should set and serialize textboxTightWrap=none (19 ms)
      âˆš should set and serialize textboxTightWrap=allLines (17 ms)
      âˆš should set and serialize textboxTightWrap=firstAndLastLine (17 ms)
      âˆš should set and serialize textboxTightWrap=firstLineOnly (22 ms)
      âˆš should set and serialize textboxTightWrap=lastLineOnly (13 ms)
      âˆš should handle undefined textboxTightWrap (38 ms)
    divId
      âˆš should set and serialize divId with positive number (18 ms)
      âˆš should handle divId round-trip with large number (16 ms)
      âˆš should handle undefined divId (20 ms)
    Combined Properties
      âˆš should handle multiple text box properties together (42 ms)
      âˆš should preserve all properties across multiple save/load cycles (75 ms)

PASS tests/elements/ImageProperties.test.ts
  Image Properties - Effect Extent
    âˆš should set and get effect extent for shadows (72 ms)
    âˆš should handle zero effect extent (22 ms)
  Image Properties - Text Wrapping
    âˆš should set square wrap with both sides (29 ms)
    âˆš should set tight wrap with left side (41 ms)
    âˆš should set top and bottom wrap (36 ms)
  Image Properties - Positioning
    âˆš should set absolute positioning with offset (54 ms)
    âˆš should set relative positioning with alignment (83 ms)
    âˆš should anchor to column (90 ms)
  Image Properties - Anchor Configuration
    âˆš should set floating image behind text (37 ms)
    âˆš should set locked floating image (30 ms)
  Image Properties - Cropping
    âˆš should set image crop on all sides (33 ms)
    âˆš should clamp crop values to 0-100 (3 ms)
  Image Properties - Visual Effects
    âˆš should set brightness and contrast (66 ms)
    âˆš should set grayscale effect (76 ms)
  Image Properties - Combined Properties
    âˆš should handle multiple properties together (89 ms)
    âˆš should preserve all properties through multiple save/load cycles (61 ms)
  Image Properties - Inline vs Floating
    âˆš should correctly identify inline images (24 ms)
    âˆš should correctly identify floating images (35 ms)

PASS tests/core/SpecialCharacters.test.ts
  Special Characters in Runs
    Tab Characters
      âˆš should preserve tab characters in text (85 ms)
      âˆš should serialize tabs as w:tab elements (22 ms)
      âˆš should handle multiple consecutive tabs (22 ms)
    Line Break Characters
      âˆš should preserve line breaks in text (21 ms)
      âˆš should serialize line breaks as w:br elements (14 ms)
      âˆš should handle Windows-style line breaks (13 ms)
    Mixed Special Characters
      âˆš should handle tabs and line breaks together (14 ms)
      âˆš should preserve order of text and special characters (25 ms)
      âˆš should handle special characters in formatted runs (16 ms)
    Non-Breaking Characters
      âˆš should handle non-breaking hyphens (22 ms)
      âˆš should serialize non-breaking hyphens correctly (19 ms)
      âˆš should handle soft hyphens (18 ms)
    Symbol Characters
      âˆš should preserve Unicode symbols (15 ms)
      âˆš should handle emoji characters (13 ms)
      âˆš should preserve special punctuation (19 ms)
    Edge Cases
      âˆš should handle empty runs with only special characters (11 ms)
      âˆš should handle very long strings with special characters (24 ms)
      âˆš should handle special characters at boundaries (15 ms)
      âˆš should round-trip complex documents without loss (29 ms)

PASS tests/formatting/StyleEnhancements.test.ts
  Style Enhancements - Phase 5.3
    Setter Methods
      âˆš should set qFormat property (6 ms)
      âˆš should set uiPriority property with validation (76 ms)
      âˆš should set semiHidden property (2 ms)
      âˆš should set unhideWhenUsed property (4 ms)
      âˆš should set locked property (2 ms)
      âˆš should set personal property (2 ms)
      âˆš should set link property (2 ms)
      âˆš should set autoRedefine property (2 ms)
      âˆš should set aliases property (2 ms)
      âˆš should support fluent API chaining (5 ms)
    Validation
      âˆš should validate uiPriority range in isValid() (2 ms)
      âˆš should prevent circular link references (2 ms)
    XML Generation
      âˆš should generate qFormat XML (2 ms)
      âˆš should generate uiPriority XML (1 ms)
      âˆš should generate semiHidden XML (3 ms)
      âˆš should generate unhideWhenUsed XML (2 ms)
      âˆš should generate locked XML (1 ms)
      âˆš should generate personal XML (2 ms)
      âˆš should generate link XML (3 ms)
      âˆš should generate autoRedefine XML (2 ms)
      âˆš should generate aliases XML (1 ms)
      âˆš should generate complete metadata XML (2 ms)
    StylesManager Helper Methods
      âˆš should get quick styles (3 ms)
      âˆš should get visible styles (2 ms)
      âˆš should get styles sorted by priority (2 ms)
      âˆš should get linked style (6 ms)
      âˆš should return undefined for non-existent linked style (1 ms)
    Round-Trip Testing
      âˆš should preserve all metadata properties through save/load cycle (36 ms)
      âˆš should handle styles with partial metadata (38 ms)
      âˆš should handle multiple styles with different metadata (27 ms)

PASS tests/core/DocumentParts.test.ts
  Document Part Access Methods
    getPart
      âˆš should retrieve an existing part (8 ms)
      âˆš should return null for non-existent part (2 ms)
      âˆš should handle binary parts correctly (4 ms)
      âˆš should retrieve content type for known parts (2 ms)
    setPart
      âˆš should add a new part (2 ms)
      âˆš should update an existing part (2 ms)
      âˆš should handle binary content (2 ms)
    removePart
      âˆš should remove an existing part (2 ms)
      âˆš should return false for non-existent part (7 ms)
      âˆš should not break document when removing optional parts (57 ms)
    listParts
      âˆš should list all parts in a new document (2 ms)
      âˆš should include newly added parts (2 ms)
      âˆš should not include removed parts (2 ms)
    partExists
      âˆš should return true for existing parts (2 ms)
      âˆš should return false for non-existent parts (2 ms)
      âˆš should reflect changes after adding/removing parts (2 ms)
    getContentTypes
      âˆš should retrieve default content types (2 ms)
      âˆš should retrieve override content types (1 ms)
    addContentType
      âˆš should add new extension content type (3 ms)
      âˆš should add new override content type (2 ms)
      âˆš should update existing content type (2 ms)
    getAllRelationships
      âˆš should retrieve all relationship files (1 ms)
      âˆš should parse relationship attributes correctly (1 ms)
      âˆš should include external relationships (9 ms)
    Document.createEmpty
      âˆš should create minimal valid DOCX structure (2 ms)
      âˆš should create a document that can be saved (4 ms)
      âˆš should create a document that can be modified (6 ms)
    Integration: URL replacement with relationship update
      âˆš should update hyperlink URLs and relationships correctly (31 ms)
      âˆš should preserve hyperlink functionality when updating URLs (36 ms)
    Edge cases and error handling
      âˆš should handle special characters in part names (3 ms)
      âˆš should handle empty content (2 ms)
      âˆš should handle large binary content (2 ms)
      âˆš should preserve XML content without modification (2 ms)

PASS tests/core/ComplexFieldParsing.test.ts
  Complex Field Parsing
    Field Type Detection
      âˆš should parse IF conditional fields (44 ms)
      âˆš should parse MERGEFIELD mail merge fields (18 ms)
      âˆš should parse INCLUDE fields (24 ms)
      âˆš should handle unknown field types as CUSTOM (30 ms)
    Field Instruction Parsing
      âˆš should preserve complete field instructions (33 ms)
      âˆš should handle field formatting switches (18 ms)
      âˆš should parse nested field instructions (14 ms)
    Field Sequences
      âˆš should handle SEQ sequence fields (21 ms)
      âˆš should handle TC table of contents entry fields (17 ms)
      âˆš should handle XE index entry fields (12 ms)
    Field Formatting Preservation
      âˆš should preserve field run formatting (14 ms)
      âˆš should handle field result text (21 ms)
    Complex Field State Machine
      âˆš should handle field begin/separate/end sequence (20 ms)
      âˆš should handle fields without separate/result (12 ms)
      âˆš should parse multiple fields in same paragraph (21 ms)
    TOC Field Whitespace Preservation
      âˆš should preserve leading and trailing whitespace in TOC instruction (13 ms)
      âˆš should preserve exact instrText content in document XML (13 ms)

PASS tests/elements/DrawingElements.test.ts
  Shape
    Factory Methods
      âˆš should create a rectangle shape (12 ms)
      âˆš should create a circle shape (1 ms)
      âˆš should create an ellipse shape (1 ms)
      âˆš should create right arrow shape (1 ms)
      âˆš should create left arrow shape (1 ms)
      âˆš should create up arrow shape
      âˆš should create down arrow shape
      âˆš should create a line shape (1 ms)
    Fill and Outline
      âˆš should set fill color (1 ms)
      âˆš should set fill with transparency
      âˆš should set outline (1 ms)
      âˆš should set dashed outline (1 ms)
    Text in Shapes
      âˆš should add text to shape
      âˆš should add formatted text to shape
    Position and Rotation
      âˆš should set rotation
      âˆš should set position (1 ms)
      âˆš should identify floating shapes (1 ms)
    XML Generation
      âˆš should generate XML for rectangle (1 ms)
      âˆš should generate XML for arrow with outline
      âˆš should generate XML for shape with text (1 ms)
    Integration with Paragraph
      âˆš should add shape to paragraph (1 ms)
  TextBox
    Factory Methods
      âˆš should create a text box
    Content Management
      âˆš should add paragraph to text box (1 ms)
      âˆš should add multiple paragraphs (9 ms)
    Fill and Borders
      âˆš should set fill color
      âˆš should set fill with transparency
      âˆš should set borders (1 ms)
    Position
      âˆš should set position (1 ms)
      âˆš should identify floating text boxes
    XML Generation
      âˆš should generate XML for empty text box (1 ms)
      âˆš should generate XML for text box with content (1 ms)
      âˆš should generate XML for text box with fill and borders
    Integration with Paragraph
      âˆš should add text box to paragraph (1 ms)
  Shape and TextBox Round-Trip
    âˆš should create document with shapes and save (36 ms)
    âˆš should create document with text boxes and save (13 ms)

PASS tests/elements/Field.test.ts
  Field Tests
    Simple Fields - Generation
      âˆš should create and serialize PAGE field (36 ms)
      âˆš should create DATE field (39 ms)
      âˆš should create TIME field (59 ms)
      âˆš should create AUTHOR field (17 ms)
      âˆš should create FILENAME field (34 ms)
      âˆš should create FILENAME field with path (20 ms)
      âˆš should create TITLE field (29 ms)
    Field Formatting
      âˆš should apply bold formatting to PAGE field (18 ms)
      âˆš should apply multiple formats to DATE field (20 ms)
    Multiple Fields
      âˆš should handle multiple fields in one paragraph (55 ms)
      âˆš should handle fields in multiple paragraphs (17 ms)
    Field Creation via Field Class
      âˆš should create field using Field.create factory (10 ms)
      âˆš should create custom field with instruction (15 ms)
    Round-Trip - Field Parsing
      âˆš should preserve PAGE field through save/load cycle (71 ms)
      âˆš should preserve DATE field through save/load cycle (66 ms)
      âˆš should preserve multiple fields through save/load cycle (29 ms)
    Edge Cases
      âˆš should handle field in empty paragraph (16 ms)
      âˆš should handle paragraph with only fields (43 ms)

PASS tests/elements/TableVMerge.test.ts
  Table Vertical Merge (vMerge)
    Basic Vertical Merging
      âˆš should merge cells vertically using vMerge (3 ms)
      âˆš should merge cells both horizontally and vertically (2 ms)
      âˆš should create valid DOCX with vertical merges (53 ms)
      âˆš should handle complex merge patterns (40 ms)
    Edge Cases
      âˆš should handle single-row merge (no vertical merge) (2 ms)
      âˆš should handle single-column merge (only vertical merge) (1 ms)
      âˆš should handle invalid merge ranges gracefully (1 ms)
    Round-trip Testing
      âˆš should preserve vMerge on round-trip (57 ms)

PASS tests/elements/RunTextEffects.test.ts
  Run Text Effects - Round Trip Tests
    Outline Text Effect
      âˆš should set outline text effect (6 ms)
      âˆš should round-trip outline text effect (52 ms)
      âˆš should support method chaining with outline (1 ms)
    Shadow Text Effect
      âˆš should set shadow text effect (1 ms)
      âˆš should round-trip shadow text effect (30 ms)
      âˆš should support method chaining with shadow (1 ms)
    Emboss Text Effect
      âˆš should set emboss text effect
      âˆš should round-trip emboss text effect (25 ms)
    Imprint Text Effect
      âˆš should set imprint text effect (1 ms)
      âˆš should round-trip imprint text effect (29 ms)
      âˆš should work with multiple effects combined (1 ms)

PASS tests/elements/ParagraphBordersShading.test.ts
  Paragraph Borders, Shading, and Tabs - Round Trip Tests
    Paragraph Borders
      âˆš should round-trip paragraph with all borders (59 ms)
      âˆš should round-trip paragraph with top and bottom borders only (64 ms)
      âˆš should round-trip paragraph with dashed borders (22 ms)
      âˆš should save borders to file and load correctly (42 ms)
    Paragraph Shading
      âˆš should round-trip paragraph with solid shading (27 ms)
      âˆš should round-trip paragraph with pattern shading (26 ms)
      âˆš should round-trip paragraph with horizontal cross pattern (30 ms)
      âˆš should save shading to file and load correctly (31 ms)
    Tab Stops
      âˆš should round-trip paragraph with multiple tab stops (39 ms)
      âˆš should round-trip paragraph with decimal tab stop (17 ms)
      âˆš should round-trip paragraph with bar tab stop (14 ms)
      âˆš should save tabs to file and load correctly (29 ms)
    Combined Features
      âˆš should round-trip paragraph with borders, shading, and tabs (14 ms)
      âˆš should save complete formatted document and load correctly (19 ms)

PASS tests/core/CommentParsing.test.ts
  Comment Parsing
    Basic Comment Parsing
      âˆš should parse comments from comments.xml (57 ms)
      âˆš should preserve comment metadata (15 ms)
      âˆš should handle comment replies (22 ms)
      âˆš should parse comment ranges in paragraphs (21 ms)
    Complex Comment Scenarios
      âˆš should handle multiple comments on same paragraph (21 ms)
      âˆš should preserve comment formatting (15 ms)
      âˆš should handle empty comments (26 ms)
    Comment Manager Integration
      âˆš should find comments by author (21 ms)
      âˆš should get comment threads (33 ms)

PASS tests/core/SDTParsing.test.ts
  SDT (Structured Document Tag) Parsing
    SDT Control Types
      âˆš should parse richText content controls (52 ms)
      âˆš should parse plainText content controls (20 ms)
      âˆš should parse dropDownList content controls (18 ms)
      âˆš should parse datePicker content controls (13 ms)
      âˆš should parse checkbox content controls (17 ms)
      âˆš should parse buildingBlock gallery controls (12 ms)
    SDT Properties
      âˆš should preserve SDT ID and tag (12 ms)
      âˆš should preserve lock state (37 ms)
      âˆš should handle temporary placeholder (15 ms)
    SDT Content
      âˆš should preserve paragraphs in SDT content (22 ms)
      âˆš should preserve tables in SDT content (17 ms)
      âˆš should handle nested SDTs (18 ms)
    Critical SDT Use Cases
      âˆš should preserve Table of Contents SDT (21 ms)
      âˆš should preserve Google Docs table wrapper SDT (18 ms)
      âˆš should handle empty SDT content (12 ms)

PASS tests/core/BookmarkParsing.test.ts
  Bookmark Parsing
    Basic Bookmark Parsing
      âˆš should parse bookmarks from document.xml (40 ms)
      âˆš should preserve bookmark IDs and names (15 ms)
      âˆš should handle bookmark name normalization (16 ms)
      âˆš should preserve exact bookmark names when loading (14 ms)
    Bookmark Cross-References
      âˆš should work with REF fields (20 ms)
      âˆš should handle duplicate bookmark names gracefully (10 ms)
    Complex Bookmark Scenarios
      âˆš should handle multiple bookmarks in same paragraph (13 ms)
      âˆš should preserve bookmark order (20 ms)
      âˆš should handle bookmarks spanning multiple paragraphs (14 ms)
    Bookmark Manager Operations
      âˆš should get unique bookmark names (20 ms)
      âˆš should count bookmarks correctly (21 ms)
      âˆš should check bookmark existence (10 ms)

PASS tests/formatting/TableStyles.test.ts
  TableStyles - Phase 5.1
    Basic Table Properties
      âˆš should set table indentation (1 ms)
      âˆš should set cell spacing (1 ms)
      âˆš should set table borders (1 ms)
      âˆš should set cell margins (8 ms)
      âˆš should set table shading
      âˆš should set table alignment
      âˆš should set cell vertical alignment
      âˆš should set row height
    Conditional Formatting
      âˆš should add firstRow conditional formatting (1 ms)
      âˆš should add lastRow conditional formatting
      âˆš should add firstCol conditional formatting
      âˆš should add lastCol conditional formatting
      âˆš should add band1Horz (row banding) (1 ms)
      âˆš should add band2Horz (even row banding)
      âˆš should add band1Vert (column banding) (1 ms)
      âˆš should add band2Vert (even column banding)
      âˆš should add nwCell (northwest corner)
      âˆš should add neCell (northeast corner) (1 ms)
      âˆš should add swCell (southwest corner)
      âˆš should add seCell (southeast corner) (1 ms)
    XML Generation
      âˆš should generate complete table style XML (1 ms)
      âˆš should generate borders XML (2 ms)
      âˆš should generate shading XML (1 ms)
      âˆš should generate margins XML
      âˆš should generate conditional formatting XML (1 ms)
    Round-Trip Testing
      âˆš should preserve table properties through save/load (64 ms)
      âˆš should preserve conditional formatting through save/load (44 ms)
      âˆš should preserve all table style properties (45 ms)

PASS tests/core/PunctuationOrdering.test.ts
  Punctuation Ordering - Regression Test
    Mixed Run and Hyperlink Ordering
      âˆš should preserve punctuation before hyperlinks (70 ms)
      âˆš should preserve punctuation after hyperlinks (17 ms)
      âˆš should handle multiple punctuation marks with hyperlinks (22 ms)
      âˆš should preserve complex mixed content (23 ms)
      âˆš should preserve exact sequence in real-world scenario (16 ms)
    Edge Cases
      âˆš should handle paragraph with only punctuation before hyperlink (2 ms)
      âˆš should handle paragraph with only hyperlink and punctuation (2 ms)
      âˆš should handle multiple consecutive hyperlinks with punctuation (33 ms)
      âˆš should not reorder elements that are already in correct order (6 ms)
    XML Structure Preservation
      âˆš should generate correct XML order in document.xml (20 ms)

PASS tests/elements/RunCharacterSpacing.test.ts
  Run Character Spacing - Round Trip Tests
    Character Spacing
      âˆš should set character spacing (2 ms)
      âˆš should round-trip positive character spacing through buffer (36 ms)
      âˆš should round-trip negative character spacing (condensed) through file (25 ms)

PASS tests/core/HeaderFooterRoundTrip.test.ts
  Header/Footer Round-Trip
    âˆš should create, save, and load document with headers/footers (132 ms)
    âˆš should handle remove header/footer operations (88 ms)
    âˆš should handle clearHeaders and clearFooters operations (53 ms)

PASS tests/elements/RunTextBorder.test.ts
  Run Text Border - Round Trip Tests
    Text Border
      âˆš should set text border with all properties (1 ms)
      âˆš should round-trip text border with single style (36 ms)
      âˆš should round-trip text border with double style (31 ms)
      âˆš should round-trip text border with dashed style (14 ms)
      âˆš should round-trip text border with thick style (19 ms)
      âˆš should save text border to file and load correctly (60 ms)
      âˆš should support method chaining with border
      âˆš should work with multiple runs with different borders (14 ms)

PASS tests/elements/ParagraphStyleConditional.test.ts
  Paragraph - Style & Conditional Properties (Batch 4)
    cnfStyle (Conditional Formatting)
      âˆš should set and serialize cnfStyle with first row and column (32 ms)
      âˆš should set and serialize cnfStyle with banding (15 ms)
      âˆš should set and serialize cnfStyle with corner cells (15 ms)
      âˆš should handle undefined cnfStyle (28 ms)
    sectPr (Section Properties)
      âˆš should set and serialize basic section properties (18 ms)
      âˆš should set and serialize section properties with page setup (13 ms)
      âˆš should handle undefined sectPr (11 ms)
    pPrChange (Change Tracking)
      âˆš should set and serialize change tracking with author and date (15 ms)
      âˆš should set and serialize change tracking with previous properties (13 ms)
      âˆš should handle undefined pPrChange (15 ms)
    Combined Properties
      âˆš should handle all three properties together (12 ms)
      âˆš should preserve all properties across multiple save/load cycles (42 ms)

PASS tests/elements/RunComplexScript.test.ts
  Run Complex Script - Round Trip Tests
    Complex Script Formatting
      âˆš should set complex script bold and italic (2 ms)
      âˆš should round-trip complex script formatting through buffer (42 ms)
      âˆš should support mixed regular and complex script formatting (40 ms)

PASS tests/utils/acceptRevisions.test.ts
  acceptRevisions Integration
    DOM-based processing
      âˆš should accept insertions from loaded document (70 ms)
      âˆš should preserve content after accepting revisions (17 ms)
      âˆš should handle empty documents (13 ms)
      âˆš should handle documents with tables (24 ms)
      âˆš should round-trip document without introducing revision markup (67 ms)
      âˆš should handle formatted text (21 ms)
    XML parsing verification
      âˆš should correctly parse and serialize XML without losing structure (1 ms)
      âˆš should preserve attributes during parsing

PASS tests/elements/RunScaling.test.ts
  Run Scaling - Round Trip Tests
    Horizontal Scaling
      âˆš should set horizontal scaling (2 ms)
      âˆš should round-trip expanded scaling through buffer (60 ms)
      âˆš should round-trip condensed scaling through file (73 ms)

PASS tests/formatting/StyleValidation.test.ts
  Style Validation Features
    Document.getStyles()
      âˆš should return all styles including built-in (13 ms)
      âˆš should include custom styles (3 ms)
    Document.removeStyle()
      âˆš should remove an existing style (9 ms)
      âˆš should return false for non-existent style (2 ms)
    Document.updateStyle()
      âˆš should update style properties (14 ms)
      âˆš should preserve styleId during update (2 ms)
      âˆš should return false for non-existent style (3 ms)
    Document.getStylesXml()
      âˆš should return raw styles XML (2 ms)
      âˆš should include all styles in XML (2 ms)
    Document.setStylesXml()
      âˆš should set raw styles XML (2 ms)
      âˆš should clear styles manager when setting XML (4 ms)
    Style.isValid()
      âˆš should validate correct style (1 ms)
      âˆš should reject style without required fields (2 ms)
      âˆš should reject invalid style type (3 ms)
      âˆš should reject circular reference (1 ms)
      âˆš should reject invalid formatting values (2 ms)
      âˆš should accept valid formatting values (1 ms)
    StylesManager.validate()
      âˆš should validate correct styles XML (6 ms)
      âˆš should detect empty XML (2 ms)
      âˆš should detect missing root element (2 ms)
      âˆš should detect duplicate style IDs (2 ms)
      âˆš should detect missing required attributes (2 ms)
      âˆš should detect circular references (2 ms)
      âˆš should detect XML corruption patterns (2 ms)
      âˆš should warn about missing Normal style (2 ms)
      âˆš should detect malformed style tags (2 ms)
    Integration: Style validation workflow
      âˆš should validate XML before setting (2 ms)
      âˆš should repair corrupted styles (2 ms)

PASS tests/elements/RunCharacterShading.test.ts
  Run Character Shading - Round Trip Tests
    Character Shading
      âˆš should set character shading with solid fill (1 ms)
      âˆš should round-trip solid shading (48 ms)
      âˆš should round-trip pattern shading (33 ms)
      âˆš should round-trip cross pattern shading (25 ms)
      âˆš should save shading to file and load correctly (75 ms)
      âˆš should support method chaining with shading (4 ms)
      âˆš should work with multiple runs with different shading (22 ms)

PASS tests/elements/Table.test.ts
  TableCell
    Basic functionality
      âˆš should create an empty cell (2 ms)
      âˆš should add text content
      âˆš should add multiple paragraphs (1 ms)
    Cell formatting
      âˆš should set width
      âˆš should set vertical alignment (1 ms)
      âˆš should set shading
      âˆš should set borders (1 ms)
      âˆš should set all borders at once (1 ms)
      âˆš should set grid span
      âˆš should set vertical merge
    Method chaining
      âˆš should support method chaining
    XML generation
      âˆš should generate basic cell XML (1 ms)
      âˆš should generate XML with formatting (1 ms)
    Static methods
      âˆš should create cell with static method (1 ms)
  TableRow
    Basic functionality
      âˆš should create empty row
      âˆš should create row with cells (1 ms)
      âˆš should add cells
      âˆš should create and add cell (1 ms)
      âˆš should get cell by index (1 ms)
      âˆš should return undefined for invalid index (2 ms)
      âˆš should get all cells
    Row formatting
      âˆš should set row height (1 ms)
      âˆš should set height rule (1 ms)
      âˆš should set header row
      âˆš should set cant split (1 ms)
    Method chaining
      âˆš should support method chaining
    XML generation
      âˆš should generate row XML with cells (1 ms)
      âˆš should generate XML with formatting (1 ms)
    Static methods
      âˆš should create row with static method
  Table
    Basic functionality
      âˆš should create empty table (1 ms)
      âˆš should create table with rows and columns
      âˆš should add row (1 ms)
      âˆš should create and add row
      âˆš should get row by index (1 ms)
      âˆš should get cell by coordinates
      âˆš should return undefined for invalid cell coordinates (1 ms)
      âˆš should set default width for ECMA-376 compliance
      âˆš should not override explicitly set width (1 ms)
    Table formatting
      âˆš should set table width
      âˆš should set table alignment
      âˆš should set table layout (1 ms)
      âˆš should set table borders
      âˆš should set all borders at once (1 ms)
      âˆš should set cell spacing (1 ms)
      âˆš should set indent
    Row operations
      âˆš should remove row (1 ms)
      âˆš should return false when removing invalid row (1 ms)
      âˆš should insert row at position
      âˆš should insert row at beginning (1 ms)
      âˆš should insert row at end
    Column operations
      âˆš should add column to all rows
      âˆš should add column at specific position (1 ms)
      âˆš should remove column from all rows
      âˆš should return false when removing invalid column
      âˆš should set column widths (1 ms)
    Method chaining
      âˆš should support method chaining (1 ms)
    XML generation
      âˆš should generate basic table XML (3 ms)
      âˆš should generate XML with formatting (4 ms)
    Static methods
      âˆš should create table with static method
    First row formatting
      âˆš should set alignment for first row (1 ms)
      âˆš should set text formatting (bold, italic, underline) for first row (1 ms)
      âˆš should set spacing for first row paragraphs (1 ms)
      âˆš should set shading for first row cells (1 ms)
      âˆš should apply all formatting options together (17 ms)
      âˆš should not affect other rows (1 ms)
      âˆš should handle empty table gracefully
      âˆš should support method chaining

PASS tests/elements/RunKerning.test.ts
  Run Kerning - Round Trip Tests
    Kerning
      âˆš should set kerning threshold (2 ms)
      âˆš should round-trip kerning through buffer (43 ms)
      âˆš should round-trip large kerning threshold through file (62 ms)

PASS tests/elements/RunCharacterStyle.test.ts
  Run Character Style Reference - Round Trip Tests
    Character Style Reference
      âˆš should set character style reference (3 ms)
      âˆš should round-trip character style reference (54 ms)
      âˆš should save character style to file and load correctly (24 ms)
      âˆš should support method chaining (1 ms)
      âˆš should work with multiple runs with different styles (12 ms)

PASS src/__tests__/helper-methods.test.ts
  Document Helper Methods
    findText
      âˆš should find text in paragraphs (6 ms)
      âˆš should find text with case sensitivity (3 ms)
      âˆš should find whole words only (4 ms)
      âˆš should find text in tables (3 ms)
    replaceText
      âˆš should replace text in paragraphs (2 ms)
      âˆš should replace multiple occurrences (3 ms)
      âˆš should replace with case sensitivity (3 ms)
      âˆš should replace whole words only (3 ms)
    getWordCount
      âˆš should count words in paragraphs (9 ms)
      âˆš should count words in tables (2 ms)
      âˆš should handle empty paragraphs (1 ms)
    getCharacterCount
      âˆš should count characters with spaces (2 ms)
      âˆš should count characters without spaces (1 ms)
      âˆš should count characters in tables (3 ms)
    removeParagraph
      âˆš should remove paragraph by object (1 ms)
      âˆš should remove paragraph by index (1 ms)
      âˆš should return false for invalid index (2 ms)
    removeTable
      âˆš should remove table by object (17 ms)
      âˆš should remove table by index (12 ms)
    insertParagraphAt
      âˆš should insert paragraph at specific position (2 ms)
      âˆš should handle edge cases (1 ms)
    getHyperlinks
      âˆš should find hyperlinks in paragraphs (2 ms)
    getBookmarks
      âˆš should find bookmarks in paragraphs (2 ms)
    getImages
      âˆš should return all images (2 ms)
    setLanguage/getLanguage
      âˆš should set and get document language (2 ms)
  Paragraph Helper Methods
    getWordCount
      âˆš should count words in paragraph
      âˆš should handle empty paragraph
      âˆš should handle multiple runs
    getLength
      âˆš should count characters with spaces (1 ms)
      âˆš should count characters without spaces (1 ms)
    clone
      âˆš should create a deep copy of paragraph (1 ms)
    setBorder
      âˆš should set paragraph borders (1 ms)
    setShading
      âˆš should set paragraph shading (1 ms)
    setTabs
      âˆš should set tab stops
  Table Helper Methods
    removeRow
      âˆš should remove row at index (2 ms)
      âˆš should return false for invalid index
    insertRow
      âˆš should insert row at position (1 ms)
      âˆš should create row with correct column count
    addColumn
      âˆš should add column to all rows (1 ms)
      âˆš should add column at specific position (1 ms)
    removeColumn
      âˆš should remove column from all rows
      âˆš should return false for invalid index
    getColumnCount
      âˆš should return maximum column count
      âˆš should return 0 for empty table (1 ms)
    setColumnWidths
      âˆš should set column widths
  Image Helper Methods
    setAltText/getAltText
      âˆš should set and get alt text (1 ms)
    rotate/getRotation
      âˆš should set and get rotation (1 ms)
      âˆš should swap dimensions on 90/270 degree rotation

PASS tests/elements/RunLanguage.test.ts
  Run Language - Round Trip Tests
    Language
      âˆš should set language code (1 ms)
      âˆš should round-trip French language through buffer (43 ms)
      âˆš should round-trip Spanish language through file (18 ms)

PASS tests/utils/InMemoryRevisionAcceptor.test.ts
  InMemoryRevisionAcceptor
    acceptRevisionsInMemory
      âˆš should accept insertion revisions by unwrapping content (11 ms)
      âˆš should accept deletion revisions by removing content (2 ms)
      âˆš should accept moveFrom revisions by removing content (2 ms)
      âˆš should accept moveTo revisions by keeping content (13 ms)
      âˆš should accept property change revisions (9 ms)
      âˆš should handle multiple revisions in a single paragraph (3 ms)
      âˆš should handle revisions across multiple paragraphs (6 ms)
    subsequent modifications after acceptance
      âˆš should allow text modifications after accepting revisions (2 ms)
      âˆš should allow formatting changes after accepting revisions (3 ms)
      âˆš should allow adding new content after accepting revisions (1 ms)
    selective acceptance options
      âˆš should only accept insertions when other options are disabled (2 ms)
      âˆš should only accept deletions when other options are disabled (2 ms)
    helper functions
      paragraphHasRevisions
        âˆš should return true when paragraph has revisions
        âˆš should return false when paragraph has no revisions
      getRevisionsFromParagraph
        âˆš should return all revisions from paragraph (1 ms)
      countRevisionsByType
        âˆš should count revisions by type across document (3 ms)
    ImageRun handling in revisions
      type guard isImageRunContent
        âˆš should correctly identify ImageRun objects (1 ms)
        âˆš should return false for regular Run objects
        âˆš should return false for null/undefined
      isRunContent with ImageRun
        âˆš should return true for ImageRun (since ImageRun extends Run)
      accepting insertions with ImageRun
        âˆš should preserve ImageRun when accepting insertion revision (2 ms)
        âˆš should preserve mixed content (text + images) in insertion revision (3 ms)
      accepting deletions with ImageRun
        âˆš should remove ImageRun when accepting deletion revision (2 ms)
      accepting moveTo with ImageRun
        âˆš should preserve ImageRun when accepting moveTo revision (1 ms)
      accepting moveFrom with ImageRun
        âˆš should remove ImageRun when accepting moveFrom revision (2 ms)
    stripRevisionsFromXml
      âˆš should unwrap insertion tags keeping content (1 ms)
      âˆš should remove deletion tags including content (1 ms)
      âˆš should remove moveFrom tags including content
      âˆš should unwrap moveTo tags keeping content (1 ms)
      âˆš should remove property change elements
      âˆš should remove run property change elements (1 ms)
      âˆš should remove range markers (1 ms)
      âˆš should handle nested revisions
      âˆš should handle XML with no revisions (1 ms)
      âˆš should handle table property changes
      âˆš should handle cell property changes
    empty table cleanup
      âˆš should remove tables with no text content after revision acceptance (2 ms)
      âˆš should preserve tables with text content (1 ms)
      âˆš should not remove empty tables when cleanup is disabled (4 ms)
      âˆš should handle multiple empty tables (2 ms)
      âˆš should handle mix of empty and non-empty tables (1 ms)
      âˆš should include emptyTablesRemoved in result even when zero (1 ms)
    Hyperlink handling in revisions
      âˆš should preserve hyperlinks when accepting insertion revisions (2 ms)
      âˆš should remove hyperlinks when accepting deletion revisions (4 ms)
      âˆš should preserve mixed content (runs and hyperlinks) in insertion revision (2 ms)

PASS tests/formatting/Numbering.test.ts
  NumberingLevel
    Basic functionality
      âˆš should create a numbering level with required properties (1 ms)
      âˆš should use default values for optional properties (1 ms)
      âˆš should calculate default indentation based on level (1 ms)
      âˆš should use custom properties when provided
    Validation
      âˆš should throw error for invalid level (60 ms)
      âˆš should allow negative left indent (outdent into margin)
      âˆš should throw error for negative hanging indent (1 ms)
      âˆš should throw error for negative start value (1 ms)
    Setters
      âˆš should set left indent
      âˆš should set hanging indent
      âˆš should set font
      âˆš should set alignment (1 ms)
      âˆš should allow negative left indent in setter (outdent) (1 ms)
      âˆš should throw error for negative hanging indent in setter (2 ms)
    Method chaining
      âˆš should support method chaining (2 ms)
    XML generation
      âˆš should generate basic level XML (1 ms)
      âˆš should generate XML with paragraph properties (1 ms)
      âˆš should generate XML with run properties
      âˆš should generate XML with suffix (1 ms)
      âˆš should generate XML with legal numbering style (1 ms)
      âˆš should generate XML with negative left indent (outdent) (2 ms)
    XML parsing
      âˆš should parse XML with negative left indent (outdent) (1 ms)
    Static factory methods
      âˆš should create bullet level with custom bullet (1 ms)
      âˆš should use Word-native defaults when no parameters provided
      âˆš should create decimal level
      âˆš should create decimal level with custom template (1 ms)
      âˆš should create lower roman level
      âˆš should create upper roman level (1 ms)
      âˆš should create lower letter level
      âˆš should create upper letter level (7 ms)
      âˆš should create level with custom properties (1 ms)
    All number formats
      âˆš should support all number formats (9 ms)
  AbstractNumbering
    Basic functionality
      âˆš should create abstract numbering with ID (1 ms)
      âˆš should add single level
      âˆš should add multiple levels (1 ms)
      âˆš should get all levels (1 ms)
      âˆš should return undefined for invalid level index (1 ms)
    Multi-level list ID
      âˆš should set and get multi-level list ID (1 ms)
    XML generation
      âˆš should generate abstract numbering XML
      âˆš should include multi-level type in XML (1 ms)
    Static factory methods
      âˆš should create bullet list (2 ms)
      âˆš should create numbered list (1 ms)
      âˆš should create outline list
  NumberingInstance
    Basic functionality
      âˆš should create numbering instance (1 ms)
      âˆš should set level overrides
      âˆš should support multiple level overrides
    XML generation
      âˆš should generate basic numbering instance XML (1 ms)
      âˆš should generate XML with level overrides (1 ms)
    Static factory method
      âˆš should create instance with static method
  NumberingManager
    Basic functionality
      âˆš should create numbering manager (1 ms)
      âˆš should add abstract numbering
      âˆš should add numbering instance (1 ms)
      âˆš should get all abstract numberings
      âˆš should get all numbering instances
    Create and register methods
      âˆš should create and register bullet list (1 ms)
      âˆš should create and register numbered list
      âˆš should create and register outline list
      âˆš should increment IDs for multiple lists
    XML generation
      âˆš should generate numbering XML document (1 ms)
      âˆš should include namespaces in root element
    Static factory method
      âˆš should create manager with static method
  Numbering Parsing Fixes
    AbstractNumbering.fromXML multiLevelType parsing
      âˆš should correctly parse singleLevel multiLevelType (1 ms)
      âˆš should correctly parse multilevel multiLevelType (1 ms)
      âˆš should correctly parse hybridMultilevel multiLevelType
    NumberingLevel.fromXML bold property parsing
      âˆš should parse bold=true from self-closing w:b element (1 ms)
      âˆš should parse bold=false from w:b w:val="0"
      âˆš should default bold to true when no w:b element present
      âˆš should parse color from w:color element
    NumberingLevel.setFormat
      âˆš should change format from lowerLetter to decimal (1 ms)
      âˆš should change format from bullet to decimal
      âˆš should be chainable (1 ms)

PASS tests/elements/RunEmphasisMarks.test.ts
  Run Emphasis Marks - Round Trip Tests
    Emphasis Marks
      âˆš should set emphasis mark (1 ms)
      âˆš should round-trip emphasis mark through buffer (45 ms)
      âˆš should round-trip emphasis mark through file (19 ms)
      âˆš should support all emphasis mark types (25 ms)

PASS tests/elements/RevisionHyperlink.test.ts
  RevisionHyperlink Tests
    Hyperlink clone() method
      âˆš should clone a hyperlink with URL (2 ms)
      âˆš should clone a hyperlink with anchor (1 ms)
      âˆš should clone hyperlink formatting
      âˆš should create independent copy (modifying clone does not affect original) (30 ms)
    Revision with Hyperlink content
      âˆš should create insertion revision with hyperlink (1 ms)
      âˆš should create deletion revision with hyperlink (1 ms)
      âˆš should add hyperlink to revision (1 ms)
      âˆš should get content including both runs and hyperlinks (1 ms)
    Type guards for RevisionContent
      âˆš should identify Run content
      âˆš should identify Hyperlink content (1 ms)
    Paragraph replaceContent() method
      âˆš should replace single item with multiple items (2 ms)
      âˆš should return false when item not found
      âˆš should maintain correct order after replacement (2 ms)
    Paragraph setContent() method
      âˆš should replace all content (1 ms)
    XML generation for revision hyperlinks
      âˆš should generate XML for insertion revision with hyperlink (1 ms)
      âˆš should generate XML for deletion revision with hyperlink (w:delText) (1 ms)
    Document round-trip with revision hyperlinks
      âˆš should create and save document with tracked hyperlink changes (88 ms)
      âˆš should handle hyperlink URL update with track changes (15 ms)
    Edge cases
      âˆš should handle empty revision content (1 ms)
      âˆš should handle revision with mixed content types
      âˆš should preserve hyperlink tooltip through clone (1 ms)
    Automatic URL/Anchor tracking
      âˆš should create delete/insert pair when setUrl() called with tracking enabled (1 ms)
      âˆš should create delete/insert pair when setAnchor() called with tracking enabled (1 ms)
      âˆš should not track when tracking is disabled
      âˆš should not track when no parent paragraph (1 ms)
      âˆš should clear parent reference after tracking
      âˆš should set parent reference when added via addHyperlink() (1 ms)
      âˆš should set parent reference when using setContent() (1 ms)

PASS tests/helpers/CleanupHelper.test.ts
  CleanupHelper
    formatAllHyperlinks
      âˆš should format internal hyperlinks (7 ms)
      âˆš should format external hyperlinks (3 ms)
      âˆš should format simple HYPERLINK fields (2 ms)
      âˆš should format complex HYPERLINK fields (2 ms)
      âˆš should format mixed hyperlink types (3 ms)
      âˆš should process hyperlinks in tables (2 ms)
      âˆš should be included in all() method (51 ms)
    Field.isHyperlinkField
      âˆš should return true for HYPERLINK type
      âˆš should return true for instruction starting with HYPERLINK
      âˆš should return false for non-HYPERLINK fields
    Field.setColor
      âˆš should set color on field (1 ms)
      âˆš should strip # from color
      âˆš should create formatting object if not exists (2 ms)

PASS src/__tests__/ensure-blank-lines-style.test.ts
  ensureBlankLinesAfter* style parameter
    ensureBlankLinesAfter1x1Tables
      âˆš should use Normal style by default (29 ms)
      âˆš should use custom style when specified (9 ms)
      âˆš should apply custom spacing and style together (4 ms)
    ensureBlankLinesAfterOtherTables
      âˆš should use Normal style by default (3 ms)
      âˆš should use custom style when specified (4 ms)
      âˆš should skip 1x1 tables (1 ms)
    backward compatibility
      âˆš ensureBlankLinesAfter1x1Tables should work without style parameter (1 ms)
      âˆš ensureBlankLinesAfterOtherTables should work without style parameter (2 ms)

PASS tests/core/DocumentBodyLevelDeletion.test.ts
  Body-Level Deletion Detection
    isPositionInsideDel detection
      âˆš should skip tables wrapped in w:del at body level (20 ms)
      âˆš should skip paragraphs wrapped in w:del at body level (8 ms)
      âˆš should preserve non-deleted tables (12 ms)
      âˆš should handle multiple deleted elements (10 ms)
      âˆš should NOT skip paragraphs containing paragraph-level w:del (run deletions) (5 ms)
      âˆš should NOT skip paragraphs with multiple run-level deletions (6 ms)

PASS tests/elements/ContentTracking.test.ts
  Content Tracking
    Paragraph.addRun() with tracking
      âˆš should wrap run in insert revision when tracking enabled (6 ms)
      âˆš should add run directly when tracking disabled (4 ms)
      âˆš should set parent reference on run (2 ms)
    Paragraph.addText() with tracking
      âˆš should wrap created run in insert revision when tracking enabled (1 ms)
      âˆš should add run directly when tracking disabled (1 ms)
    Paragraph.addHyperlink() with tracking
      âˆš should wrap hyperlink in insert revision when tracking enabled (1 ms)
    Paragraph.clearContent() with tracking
      âˆš should wrap content in delete revisions when tracking enabled (2 ms)
      âˆš should clear content directly when tracking disabled (1 ms)
    Paragraph.removeContentAt() with tracking
      âˆš should wrap removed item in delete revision when tracking enabled (2 ms)
    Run.setText() with tracking
      âˆš should create delete/insert revisions when text changes with tracking (3 ms)
      âˆš should not create revisions when text changes without tracking (2 ms)
      âˆš should not create revisions when text unchanged (1 ms)
      âˆš should not create revisions for runs without parent (1 ms)
    RevisionManager registration
      âˆš should register insert revisions with RevisionManager (1 ms)
      âˆš should register delete revisions with RevisionManager (1 ms)

PASS tests/elements/ParentTracking.test.ts
  Parent Tracking
    Paragraph -> TableCell
      âˆš should set parent cell when adding paragraph with addParagraph() (1 ms)
      âˆš should set parent cell when creating paragraph with createParagraph() (1 ms)
      âˆš should set parent cell when adding paragraph at index with addParagraphAt()
      âˆš should clear parent cell when removing paragraph
      âˆš should report isInTableCell() correctly
      âˆš should return cell cnfStyle from getTableConditionalStyle() (1 ms)
      âˆš should return paragraph cnfStyle if not in cell
      âˆš should prefer cell cnfStyle over paragraph cnfStyle
    TableCell -> TableRow
      âˆš should set parent row when adding cell with addCell()
      âˆš should set parent row when creating cell with createCell()
      âˆš should set parent row on cells created in constructor (1 ms)
    TableRow -> Table
      âˆš should set parent table when adding row with addRow()
      âˆš should set parent table when creating row with createRow() (1 ms)
      âˆš should set parent table on rows created in constructor
    Full Parent Chain
      âˆš should traverse from Paragraph to Table
      âˆš should return table style ID through getTableStyleId() (1 ms)
      âˆš should return undefined for getTableStyleId() if not in table
      âˆš should return undefined for getTableStyleId() if table has no style (1 ms)
    Run -> Paragraph (existing)
      âˆš should set parent paragraph when adding run (1 ms)
    Run getEffective* methods
      âˆš should return direct formatting from getEffectiveBold()
      âˆš should return undefined if no bold formatting (1 ms)
      âˆš should return direct formatting from getEffectiveItalic()
      âˆš should return direct formatting from getEffectiveColor()
      âˆš should return direct formatting from getEffectiveFont()
      âˆš should return direct formatting from getEffectiveSize() (1 ms)
      âˆš should return undefined for run not in paragraph
      âˆš should return undefined for run in paragraph but not in cell (1 ms)
      âˆš should traverse parent chain for run in table cell (1 ms)
    Style Resolution via Document
      âˆš should resolve bold from table conditional formatting (firstRow) (10 ms)
      âˆš should resolve italic from table conditional formatting (lastCol) (2 ms)
      âˆš should resolve color from wholeTable conditional (2 ms)
      âˆš should prioritize direct formatting over conditional (3 ms)
      âˆš should prioritize corner over edge conditionals (1 ms)
      âˆš should return undefined if no table style defined (2 ms)
      âˆš should return undefined if style has no conditional formatting (2 ms)
    Edge cases
      âˆš should handle paragraph moved between cells (1 ms)
      âˆš should handle deeply nested table structure
    Default Bold via tblLook (no table style)
      âˆš should apply default bold for firstColumn when tblLook.firstColumn is enabled (1 ms)
      âˆš should apply default bold for firstRow when tblLook.firstRow is enabled (1 ms)
      âˆš should NOT apply default bold when tblLook flag is not enabled (1 ms)
      âˆš should decode tblLook hex string correctly

PASS tests/core/PropertyChangeTracking.test.ts
  Property Change Tracking
    Run Property Changes (w:rPrChange)
      Basic formatting
        âˆš should parse bold property change (2 ms)
        âˆš should parse italic property change (1 ms)
        âˆš should parse underline property change
        âˆš should parse strikethrough property change
        âˆš should parse double strikethrough property change
      Font and color
        âˆš should parse font property change
        âˆš should parse size property change (half-points to points)
        âˆš should parse color property change (1 ms)
        âˆš should ignore auto color value
        âˆš should parse highlight property change
      Text effects
        âˆš should parse outline property change
        âˆš should parse shadow property change (1 ms)
        âˆš should parse emboss property change (1 ms)
        âˆš should parse imprint property change
      Caps and vertical alignment
        âˆš should parse smallCaps property change
        âˆš should parse allCaps property change
        âˆš should parse subscript property change
        âˆš should parse superscript property change (2 ms)
      Hidden and proofing
        âˆš should parse vanish property change (1 ms)
        âˆš should parse specVanish property change
        âˆš should parse noProof property change (1 ms)
      RTL and complex scripts
        âˆš should parse rtl property change
        âˆš should parse complex script bold property change (1 ms)
        âˆš should parse complex script italic property change
      Spacing and positioning
        âˆš should parse characterSpacing property change
        âˆš should parse scaling property change (1 ms)
        âˆš should parse position property change
        âˆš should parse kerning property change (1 ms)
      Language and style
        âˆš should parse language property change (2 ms)
        âˆš should parse characterStyle property change (1 ms)
      Border and shading
        âˆš should parse text border property change (1 ms)
        âˆš should parse character shading property change (1 ms)
      East Asian layout
        âˆš should parse eastAsianLayout property change (1 ms)
    Paragraph Property Changes (w:pPrChange)
      Style and alignment
        âˆš should parse style property change (1 ms)
        âˆš should parse alignment property change
      Keep properties
        âˆš should parse keepNext property change (1 ms)
        âˆš should parse keepLines property change
        âˆš should parse pageBreakBefore property change
        âˆš should parse widowControl property change (1 ms)
      Spacing and hyphenation
        âˆš should parse suppressAutoHyphens property change
        âˆš should parse contextualSpacing property change (1 ms)
        âˆš should parse mirrorIndents property change
      Outline and direction
        âˆš should parse outlineLevel property change (1 ms)
        âˆš should parse bidi property change
        âˆš should parse textDirection property change
      Grid and spacing options
        âˆš should parse suppressLineNumbers property change
        âˆš should parse adjustRightInd property change (1 ms)
        âˆš should parse snapToGrid property change (1 ms)
        âˆš should parse wordWrap property change
        âˆš should parse autoSpaceDE property change (1 ms)
        âˆš should parse autoSpaceDN property change
      Borders
        âˆš should parse paragraph borders property change (1 ms)
      Shading
        âˆš should parse paragraph shading property change (1 ms)
      Tabs
        âˆš should parse single tab stop property change
        âˆš should parse multiple tab stops property change (1 ms)

PASS tests/elements/ContentControls.test.ts
  ContentControls - Rich Text
    âˆš should create rich text control (1 ms)
    âˆš should generate correct XML for rich text control (2 ms)
  ContentControls - Plain Text
    âˆš should create plain text control (1 ms)
    âˆš should create multiline plain text control
    âˆš should generate correct XML for plain text control (1 ms)
  ContentControls - Combo Box
    âˆš should create combo box control
    âˆš should generate correct XML for combo box control (1 ms)
  ContentControls - Dropdown List
    âˆš should create dropdown list control
    âˆš should generate correct XML for dropdown list control
  ContentControls - Date Picker
    âˆš should create date picker control (1 ms)
    âˆš should generate correct XML for date picker control
    âˆš should include full date in XML when provided (1 ms)
  ContentControls - Checkbox
    âˆš should create checkbox control - unchecked
    âˆš should create checkbox control - checked (1 ms)
    âˆš should generate correct XML for checkbox control
  ContentControls - Picture
    âˆš should create picture control (1 ms)
    âˆš should generate correct XML for picture control
  ContentControls - Building Block
    âˆš should create building block control (1 ms)
    âˆš should generate correct XML for building block control (1 ms)
  ContentControls - Group
    âˆš should create group control
    âˆš should generate correct XML for group control
  ContentControls - Document Integration
    âˆš should create document with rich text control (31 ms)
    âˆš should create document with multiple control types (13 ms)

PASS src/__tests__/clearCustom.test.ts
  Document.clearCustom()
    Basic SDT removal
      âˆš should remove SDTs from body while preserving content (4 ms)
      âˆš should preserve formatting of unwrapped content (30 ms)
    Nested SDT handling
      âˆš should handle nested SDTs recursively (2 ms)
      âˆš should preserve multiple paragraphs from single SDT (4 ms)
    Table cell SDT handling
      âˆš should remove SDTs from table cells (3 ms)
    Complex document scenarios
      âˆš should handle mixed content with multiple SDTs (4 ms)
      âˆš should be chainable with other methods (2 ms)
      âˆš should work with empty document (2 ms)
      âˆš should work with document containing only SDTs (3 ms)
    Save and reload after clearCustom
      âˆš should produce valid document after clearing (69 ms)
    Google Docs SDT-wrapped tables with row exceptions
      âˆš should clear tblPrEx from table rows when unwrapping SDTs (4 ms)
      âˆš should preserve table structure when clearing tblPrEx (3 ms)
      âˆš should handle multiple SDT-wrapped tables with row exceptions (2 ms)

PASS tests/elements/Paragraph.test.ts
  Run
    Basic functionality
      âˆš should create a run with text (5 ms)
      âˆš should set text (1 ms)
      âˆš should create run with formatting (1 ms)
    Formatting methods
      âˆš should set bold (1 ms)
      âˆš should set italic
      âˆš should set underline (1 ms)
      âˆš should set underline with style
      âˆš should set strike
      âˆš should set subscript (1 ms)
      âˆš should set superscript
      âˆš should toggle between subscript and superscript (2 ms)
      âˆš should set font
      âˆš should set font without size (1 ms)
      âˆš should set size
      âˆš should set color (1 ms)
      âˆš should set color without hash
      âˆš should set highlight (1 ms)
      âˆš should set small caps (1 ms)
      âˆš should set all caps
    Method chaining
      âˆš should support method chaining (1 ms)
    XML generation
      âˆš should generate basic XML (1 ms)
      âˆš should generate XML with formatting
      âˆš should preserve spaces with xml:space attribute (1 ms)
    Static methods
      âˆš should create run with static method
  Paragraph
    Basic functionality
      âˆš should create empty paragraph
      âˆš should add run
      âˆš should add text (1 ms)
      âˆš should set text
      âˆš should get combined text from multiple runs (2 ms)
      âˆš should include hyperlink text in getText (1 ms)
      âˆš should handle hyperlink-only paragraph (1 ms)
      âˆš should handle multiple hyperlinks and runs
      âˆš should handle hyperlink before runs
      âˆš should handle internal hyperlinks in getText (1 ms)
    Formatting methods
      âˆš should set alignment (1 ms)
      âˆš should set left indent
      âˆš should set right indent
      âˆš should set first line indent
      âˆš should set space before (1 ms)
      âˆš should set space after
      âˆš should set line spacing (1 ms)
      âˆš should set style (13 ms)
      âˆš should set keep next (3 ms)
      âˆš should set keep lines (1 ms)
      âˆš should set page break before (1 ms)
    Method chaining
      âˆš should support method chaining (2 ms)
    XML generation
      âˆš should generate basic XML
      âˆš should generate XML with empty run if no text (3 ms)
      âˆš should generate XML with alignment (1 ms)
      âˆš should generate XML with multiple formatted runs (1 ms)
    Static methods
      âˆš should create paragraph with static method (1 ms)
    Detached paragraphs
      Paragraph.create()
        âˆš should create empty detached paragraph
        âˆš should create detached paragraph with text
        âˆš should create detached paragraph with text and formatting (1 ms)
        âˆš should create detached paragraph with just formatting
        âˆš should support method chaining after creation
      Paragraph.createWithStyle()
        âˆš should create detached paragraph with style (2 ms)
        âˆš should support method chaining with styled paragraph
      Paragraph.createEmpty()
        âˆš should create empty detached paragraph (1 ms)
        âˆš should allow adding content after creation
      Paragraph.createFormatted()
        âˆš should create detached paragraph with run and paragraph formatting (1 ms)
        âˆš should work without paragraph formatting (1 ms)
        âˆš should work without run formatting (1 ms)
      Complex detached paragraph scenarios
        âˆš should build complex paragraph with multiple runs
        âˆš should clone detached paragraph (1 ms)
        âˆš should set complex formatting on detached paragraph (1 ms)
        âˆš should generate proper XML from detached paragraph (1 ms)
      Style application with formatting control
        âˆš should clear all direct run formatting (1 ms)
        âˆš should clear only specified run properties
        âˆš should apply style and clear all formatting (1 ms)
        âˆš should apply style and clear specific properties (1 ms)
        âˆš should apply style without clearing formatting when not specified
        âˆš should handle paragraph with multiple runs (1 ms)
        âˆš should support method chaining (1 ms)
      Property conflict resolution
        âˆš should clear pageBreakBefore when keepNext is set (1 ms)
        âˆš should clear pageBreakBefore when keepLines is set
        âˆš should not affect pageBreakBefore when keepNext is set to false (1 ms)
        âˆš should work with method chaining
        âˆš should work when keepNext/keepLines are set first (1 ms)
        âˆš should produce correct XML without conflicting properties (1 ms)
        âˆš should handle conflicts in constructor formatting
      getRuns with nested content
        âˆš should return runs from inside revisions (1 ms)
        âˆš should return runs from inside hyperlinks (1 ms)
        âˆš should allow formatting runs inside revisions
        âˆš should combine direct runs, revision runs, and hyperlink runs (1 ms)

  console.log
    Skipping test: hyperlinks_autoaccept_off.docx not found

      at Object.<anonymous> (tests/core/RevisionInField.test.ts:29:17)

  console.log
    Skipping test: hyperlinks_autoaccept_off.docx not found

      at Object.<anonymous> (tests/core/RevisionInField.test.ts:65:17)

  console.log
    Skipping test: hyperlinks_autoaccept_off.docx not found

      at Object.<anonymous> (tests/core/RevisionInField.test.ts:101:17)

  console.log
    Skipping test: hyperlinks_autoaccept_off.docx not found

      at Object.<anonymous> (tests/core/RevisionInField.test.ts:132:17)

  console.log
    Skipping test: hyperlinks_autoaccept_off.docx not found

      at Object.<anonymous> (tests/core/RevisionInField.test.ts:171:17)

PASS tests/core/RevisionInField.test.ts
  Revisions Inside Complex Fields
    Field Assembly with Revisions
      âˆš should detect revisions inside HYPERLINK field result sections (59 ms)
      âˆš should correctly decode URL-encoded HYPERLINK instructions (6 ms)
      âˆš should parse HYPERLINK with \l anchor switch correctly (8 ms)
      âˆš should associate revisions with adjacent complex fields (3 ms)
    Round-trip preservation
      âˆš should preserve HYPERLINK fields after load and save (2 ms)

PASS tests/elements/TableCellPositionTracking.test.ts
  TableCell Position Tracking
    removeParagraph position updates
      âˆš should decrement rawNestedContent positions when paragraph is removed before nested content (3 ms)
      âˆš should NOT change rawNestedContent position when paragraph is removed after nested content
      âˆš should handle multiple rawNestedContent items correctly (1 ms)
    addParagraphAt position updates
      âˆš should increment rawNestedContent positions when paragraph is inserted before nested content (1 ms)
      âˆš should NOT change rawNestedContent position when paragraph is added after nested content
    removeTrailingBlankParagraphs
      âˆš should remove trailing blank paragraphs from cell (1 ms)
      âˆš should keep at least one paragraph in cell (1 ms)
      âˆš should stop at non-blank paragraph (2 ms)
      âˆš should respect preserve flag when ignorePreserveFlag is false
      âˆš should ignore preserve flag when ignorePreserveFlag is true (1 ms)
      âˆš should NOT remove blank if raw nested content is positioned after it (1 ms)
  Document removeTrailingBlanksInTableCells
    âˆš should remove trailing blanks from all table cells (4 ms)
    âˆš should be called by removeExtraBlankParagraphs when option is enabled (6 ms)
    âˆš should call removeTrailingBlanksInTableCells directly to remove trailing blanks (4 ms)

PASS tests/elements/RunPosition.test.ts
  Run Position - Round Trip Tests
    Vertical Position
      âˆš should set vertical position (1 ms)
      âˆš should round-trip raised position through buffer (53 ms)
      âˆš should round-trip lowered position through file (33 ms)

PASS tests/xml/XMLParser-parseToObject.test.ts
  XMLParser.parseToObject
    Basic Parsing
      âˆš should parse single element with attributes (1 ms)
      âˆš should parse nested elements (7 ms)
      âˆš should parse self-closing tags (1 ms)
      âˆš should parse element with text content
      âˆš should parse element with attributes and text (1 ms)
      âˆš should handle empty elements (1 ms)
    Relationships XML (Real-world OOXML)
      âˆš should parse single Relationship element
      âˆš should parse multiple Relationship elements as array (1 ms)
      âˆš should handle single vs array normalization (1 ms)
      âˆš should preserve relationship attributes
    Styles XML (Complex Nested)
      âˆš should parse WordprocessingML styles
      âˆš should preserve namespaces in element names (1 ms)
      âˆš should handle complex nested formatting (1 ms)
      âˆš should handle self-closing formatting tags (1 ms)
    Document XML (Text Content)
      âˆš should parse paragraph with text (1 ms)
      âˆš should handle #text property for mixed content
      âˆš should trim whitespace by default
      âˆš should preserve whitespace when trimValues=false (1 ms)
      âˆš should handle multiple runs
    Edge Cases
      âˆš should handle empty XML (1 ms)
      âˆš should handle XML declaration
      âˆš should handle comments
      âˆš should handle special characters in text (1 ms)
      âˆš should handle numeric attribute values (1 ms)
      âˆš should handle boolean attribute values (1 ms)
      âˆš should handle nested elements with same name
      âˆš should correctly parse nested self-closing tags with same name (rPrChange bug fix) (2 ms)
      âˆš should throw on oversized documents (28 ms)
    Options Configuration
      âˆš should ignore attributes when ignoreAttributes=true (1 ms)
      âˆš should use custom attribute prefix
      âˆš should use custom text node name (2 ms)
      âˆš should ignore namespaces when ignoreNamespace=true
      âˆš should not parse attribute values when parseAttributeValue=false (1 ms)
      âˆš should always create arrays when alwaysArray=true (1 ms)
      âˆš should combine multiple options (1 ms)
    Real-world OOXML Scenarios
      âˆš should parse [Content_Types].xml
      âˆš should parse document.xml structure (1 ms)
      âˆš should parse numbering.xml (1 ms)
    Performance
      âˆš should parse typical .rels file quickly (1 ms)
      âˆš should handle moderately large documents (5 ms)

PASS tests/core/ListNormalizer.test.ts
  ListNormalizer
    normalizeListsInCell - list restart behavior
      âˆš should restart sub-list numbering when a new parent level item appears (8 ms)
      âˆš should keep same numId for consecutive items at same level (4 ms)
      âˆš should handle multiple level transitions correctly (3 ms)
      âˆš should shift level 1 items to level 0 when no level 0 parent exists (3 ms)
      âˆš should shift multi-level lists without level 0 parent (3 ms)
      âˆš should handle multiple list groups separated by non-list text (3 ms)
    normalizeOrphanListLevelsInCell
      âˆš should shift Level 1 bullets to Level 0 when no Level 0 exists (3 ms)
      âˆš should not change Level 0 bullets (1 ms)
      âˆš should shift mixed levels down by minimum level (1 ms)
      âˆš should handle cells with no list items (2 ms)
      âˆš should handle cells with mix of list and non-list paragraphs (2 ms)
      âˆš should handle Level 3+ orphan bullets (2 ms)
    normalizeOrphanListLevelsInTable
      âˆš should normalize orphan levels across all cells in a table (2 ms)
      âˆš should handle empty table (2 ms)
      âˆš should handle large table with many cells (4 ms)
    detectTypedPrefix - abbreviation handling
      âˆš should NOT detect "P. O. Box" as a list marker (1 ms)
      âˆš should NOT detect "U.S. Army" as a list marker
      âˆš should detect "A. First item" as a list marker (1 ms)
      âˆš should detect "a. lowercase item" as a list marker
      âˆš should detect "1. Numbered item" as a list marker
      âˆš should NOT detect "P.O. Box" without spaces as a list marker (1 ms)
      âˆš should preserve P. O. Box text in cell normalization (1 ms)

PASS tests/utils/validation.test.ts
  Validation Utilities
    validateDocxStructure
      âˆš should not throw for valid DOCX structure (1 ms)
      âˆš should throw when missing [Content_Types].xml (28 ms)
      âˆš should throw when missing _rels/.rels (1 ms)
      âˆš should throw when missing word/document.xml (1 ms)
      âˆš should validate all required files
    isBinaryFile
      âˆš should identify image files as binary (1 ms)
      âˆš should identify font files as binary
      âˆš should identify text files as non-binary (1 ms)
      âˆš should be case-insensitive
      âˆš should handle paths with directories (1 ms)
    normalizePath
      âˆš should convert backslashes to forward slashes
      âˆš should remove leading slashes
      âˆš should handle mixed slashes (1 ms)
      âˆš should preserve forward slashes in middle of path
      âˆš should handle empty string
      âˆš should handle single file name
      âˆš should reject path traversal with ../ (Unix) (2 ms)
      âˆš should reject path traversal with ..\ (Windows) (1 ms)
      âˆš should reject absolute Windows paths (3 ms)
      âˆš should allow valid relative paths
    isValidZipBuffer
      âˆš should recognize valid ZIP signature (1 ms)
      âˆš should recognize empty ZIP signature
      âˆš should reject invalid signature
      âˆš should reject buffer too small
      âˆš should reject text files
      âˆš should reject PDF signature
    isTextContent
      âˆš should identify string as text (1 ms)
      âˆš should identify UTF-8 buffer as text
      âˆš should identify buffer with null bytes as binary
      âˆš should handle unicode text
      âˆš should identify binary data as non-text
      âˆš should handle empty string (1 ms)
      âˆš should handle empty buffer

PASS tests/elements/ParagraphNumberingIndent.test.ts
  Paragraph - Numbering and Indentation Conflict Resolution
    setNumbering() clears conflicting indentation
      âˆš should clear left indentation when numbering is applied (2 ms)
      âˆš should clear firstLine indentation when numbering is applied (1 ms)
      âˆš should clear hanging indentation when numbering is applied (1 ms)
      âˆš should clear multiple indentation properties when numbering is applied
      âˆš should preserve right indentation when numbering is applied
      âˆš should handle numbering when no indentation exists (1 ms)
    Warnings when setting indentation on numbered paragraphs
      âˆš should warn when setting left indent on numbered paragraph (1 ms)
      âˆš should warn when setting first line indent on numbered paragraph
      âˆš should not warn when setting right indent on numbered paragraph (1 ms)
      âˆš should not warn when setting indent on non-numbered paragraph
    Edge cases and complex scenarios
      âˆš should handle changing numbering levels
      âˆš should handle numbering applied multiple times (1 ms)
      âˆš should handle indent set before and after numbering (1 ms)
      âˆš should preserve right indent across numbering changes (1 ms)
    XML generation with conflict resolution
      âˆš should not include left indent in XML when numbering is present (1 ms)
      âˆš should include right indent in XML with numbering (1 ms)
    Numbering validation
      âˆš should throw error for negative numId (50 ms)
      âˆš should throw error for level < 0 (1 ms)
      âˆš should throw error for level > 8 (1 ms)
      âˆš should accept valid levels 0-8 (2 ms)

PASS tests/utils/SelectiveRevisionAcceptor.test.ts
  SelectiveRevisionAcceptor
    accept
      âˆš should accept revisions matching criteria (2 ms)
      âˆš should return empty result for document without revision manager (1 ms)
      âˆš should accept nothing if no criteria matches
    reject
      âˆš should reject revisions matching criteria (1 ms)
    preview
      âˆš should preview accept action
      âˆš should preview reject action (1 ms)
    acceptByAuthor
      âˆš should accept all revisions by specific author (1 ms)
    rejectByAuthor
      âˆš should reject all revisions by specific author
    acceptByType
      âˆš should accept all revisions of specific types (2 ms)
    rejectByType
      âˆš should reject all revisions of specific types (2 ms)
    acceptBeforeDate
      âˆš should accept revisions before cutoff date (1 ms)
    acceptAfterDate
      âˆš should accept revisions after start date (1 ms)
    acceptInsertionsOnly
      âˆš should accept only insertions
    acceptDeletionsOnly
      âˆš should accept only deletions (1 ms)
    rejectFormattingChanges
      âˆš should reject formatting changes (1 ms)
    acceptContentChangesOnly
      âˆš should accept only content changes
    category filtering
      âˆš should correctly categorize table changes (1 ms)
      âˆš should correctly categorize structural changes (2 ms)
    custom filter
      âˆš should apply custom filter function (1 ms)
    combined criteria
      âˆš should combine multiple criteria with AND logic

PASS tests/elements/RevisionManager.test.ts
  RevisionManager
    Basic Operations
      âˆš should create empty manager (1 ms)
      âˆš should register revisions and assign unique IDs (1 ms)
      âˆš should return the registered revision from register() (1 ms)
      âˆš should clear all revisions
      âˆš should reset nextId after clear
    Retrieval Methods
      âˆš should get all revisions (1 ms)
      âˆš should return defensive copy from getAllRevisions
      âˆš should get revisions by type
      âˆš should get revisions by author
      âˆš should get revision by ID (1 ms)
      âˆš should return undefined for non-existent ID
      âˆš should get all insertions (1 ms)
      âˆš should get all deletions (1 ms)
      âˆš should get all property changes (1 ms)
    Count Methods
      âˆš should return total count (1 ms)
      âˆš should return insertion count
      âˆš should return deletion count (1 ms)
    Author Methods
      âˆš should get unique authors (1 ms)
    Date Range Filtering
      âˆš should filter by date range
      âˆš should include boundary dates (1 ms)
    Text Search
      âˆš should find revisions by text (case-insensitive)
      âˆš should find revisions containing partial match (1 ms)
      âˆš should return empty array for no matches
    Recent Revisions
      âˆš should return most recent N revisions (1 ms)
      âˆš should return all if N exceeds total
    Latest Revision
      âˆš should return undefined when empty (1 ms)
      âˆš should return last registered revision
    Category Filtering
      âˆš should filter by content category (1 ms)
      âˆš should filter by formatting category (1 ms)
      âˆš should filter by structural category
      âˆš should filter by table category (1 ms)
      âˆš should include internal tracking types in content category
      âˆš should include bookmarkChange in structural category (1 ms)
    Move Operations
      âˆš should get all moves
      âˆš should get all moveFrom (1 ms)
      âˆš should get all moveTo
      âˆš should get move pair by ID (1 ms)
      âˆš should return partial pair for orphaned move (1 ms)
    Statistics
      âˆš should get comprehensive stats (1 ms)
      âˆš should get summary with date range (1 ms)
    Validation
      âˆš should validate unique revision IDs
      âˆš should detect duplicate revision IDs (1 ms)
      âˆš should validate move pairs
      âˆš should detect orphaned moveFrom (1 ms)
      âˆš should detect orphaned moveTo
    ID Management
      âˆš should peek next ID without incrementing (1 ms)
      âˆš should consume next ID
      âˆš should get highest ID (1 ms)
      âˆš should return -1 for highest ID when empty
      âˆš should reassign all IDs (1 ms)
      âˆš should sync next ID after loading
    Location-Based Queries
      âˆš should get revisions for paragraph (1 ms)
      âˆš should get revisions for specific run
      âˆš should return empty for negative paragraph index (1 ms)
      âˆš should get revisions with location
      âˆš should get revisions without location
      âˆš should get revisions by location criteria (1 ms)
    Multi-Criteria Matching
      âˆš should match by types
      âˆš should match by authors
      âˆš should match by types AND authors (1 ms)
      âˆš should match by date range
      âˆš should match by all criteria
    Status Methods
      âˆš should report not tracking when empty
      âˆš should report tracking when has revisions (1 ms)
    Remove Operations
      âˆš should remove revision by ID
      âˆš should return false for non-existent ID (1 ms)
    Static Factory
      âˆš should create manager via static method

PASS tests/elements/FieldTypes.test.ts
  Field Types - Page Fields
    âˆš should create PAGE field (2 ms)
    âˆš should create NUMPAGES field
    âˆš should create SECTIONPAGES field (1 ms)
    âˆš should generate XML for page number field (1 ms)
  Field Types - Reference Fields
    âˆš should create REF field with bookmark
    âˆš should create REF field with custom format (1 ms)
    âˆš should create HYPERLINK field
    âˆš should create HYPERLINK field with tooltip
    âˆš should create SEQ field
    âˆš should create SEQ field with Roman numerals
    âˆš should generate XML for REF field (1 ms)
  Field Types - Document Property Fields
    âˆš should create AUTHOR field
    âˆš should create TITLE field
    âˆš should create FILENAME field (1 ms)
    âˆš should create FILENAME field with path
    âˆš should create TC entry field (5 ms)
    âˆš should create TC entry field with level 3 (1 ms)
    âˆš should throw error for invalid TC level (24 ms)
    âˆš should create XE entry field (1 ms)
    âˆš should create XE entry field with sub-entry
  Field Types - Date and Time Fields
    âˆš should create DATE field
    âˆš should create DATE field with format (1 ms)
    âˆš should create TIME field
    âˆš should create TIME field with format
  Field Types - Formatting
    âˆš should apply bold formatting to field (1 ms)
    âˆš should apply multiple formatting options
  Field Types - XML Generation
    âˆš should generate correct XML structure for all field types (18 ms)
    âˆš should include placeholder text in XML
  Field Types - Factory Methods
    âˆš should create field using generic create method
    âˆš should create custom field (1 ms)
  Field Types - Integration
    âˆš should support method chaining for formatting
    âˆš should preserve field instruction when formatting changes
    âˆš should generate valid field codes for all types (1 ms)

PASS tests/utils/RevisionAwareProcessor.test.ts
  RevisionAwareProcessor
    hasTrackedChanges
      âˆš should return false for document without revisions (1 ms)
      âˆš should return true for document with revisions (1 ms)
    getTrackedChangesSummary
      âˆš should return null for document without revision manager (1 ms)
      âˆš should return summary for document with revisions (1 ms)
    prepare
      âˆš should handle document without revisions (1 ms)
      âˆš should preserve revisions in preserve mode (1 ms)
      âˆš should track revisions for preserve_and_wrap mode
      âˆš should log processing actions (1 ms)
    acceptSelective
      âˆš should filter revisions by type
      âˆš should filter revisions by author (1 ms)
      âˆš should filter revisions by category (1 ms)
      âˆš should apply custom filter
    checkConflict
      âˆš should return null for document without revision manager (1 ms)
      âˆš should return revision if conflict exists
    getAffectedRevisions
      âˆš should return empty array for document without revision manager (1 ms)

PASS tests/elements/Section.test.ts
  Section
    Basic functionality
      âˆš should create section with default properties (12 ms)
      âˆš should create section with custom properties (1 ms)
    Page size
      âˆš should set page size
      âˆš should set page orientation
      âˆš should swap dimensions for landscape orientation
    Margins
      âˆš should set margins (1 ms)
      âˆš should set gutter margin (1 ms)
    Columns
      âˆš should set column layout (1 ms)
      âˆš should use default spacing for columns
    Section type
      âˆš should set section type
      âˆš should support all section types (1 ms)
    Page numbering
      âˆš should set page numbering start
      âˆš should set page numbering format
      âˆš should set only format without start
    Headers and footers
      âˆš should set title page flag
      âˆš should set header references (1 ms)
      âˆš should set footer references
    Method chaining
      âˆš should support method chaining (1 ms)
    XML generation
      âˆš should generate basic section XML (1 ms)
      âˆš should generate XML with landscape orientation (1 ms)
      âˆš should generate XML with multiple columns
      âˆš should generate XML with page numbering
      âˆš should generate XML with title page (1 ms)
      âˆš should generate XML with headers and footers
      âˆš should generate XML with gutter margin
    clone()
      âˆš should create an independent clone with all properties (3 ms)
      âˆš should create independent objects (not references)
      âˆš should handle section with minimal properties (1 ms)
      âˆš should deep clone columnWidths array
    Static factory methods
      âˆš should create section with default properties (1 ms)
      âˆš should create letter-sized section
      âˆš should create A4-sized section (1 ms)
      âˆš should create landscape letter section
      âˆš should create landscape A4 section (1 ms)
      âˆš should default to letter for landscape

PASS tests/utils/ChangelogGenerator.test.ts
  ChangelogGenerator
    categorize
      âˆš should categorize insert as content (1 ms)
      âˆš should categorize delete as content
      âˆš should categorize moveFrom as structural
      âˆš should categorize moveTo as structural (1 ms)
      âˆš should categorize runPropertiesChange as formatting
      âˆš should categorize paragraphPropertiesChange as formatting
      âˆš should categorize tablePropertiesChange as table (1 ms)
      âˆš should categorize tableCellInsert as table
      âˆš should categorize sectionPropertiesChange as structural
    describeRevision
      âˆš should describe insertion (1 ms)
      âˆš should describe deletion
      âˆš should truncate long text (1 ms)
      âˆš should describe moveFrom
      âˆš should describe moveTo
      âˆš should describe table cell insert (1 ms)
    fromRevisions
      âˆš should convert revisions to changelog entries (1 ms)
      âˆš should filter by author (1 ms)
      âˆš should filter by category
      âˆš should filter out formatting changes when requested (1 ms)
      âˆš should filter by date range
      âˆš should set content.after for insertions (1 ms)
      âˆš should set content.before for deletions
    getSummary
      âˆš should return correct total count (1 ms)
      âˆš should count by category (1 ms)
      âˆš should count by author (1 ms)
      âˆš should track date range
      âˆš should return null date range for empty entries (1 ms)
    consolidate
      âˆš should group similar changes
      âˆš should not group changes from different authors
      âˆš should group property changes with same property and value (1 ms)
      âˆš should sort consolidated changes by count descending
    toMarkdown
      âˆš should generate valid markdown (1 ms)
      âˆš should include metadata when requested (1 ms)
      âˆš should not include metadata when disabled
    toPlainText
      âˆš should generate plain text output (1 ms)
      âˆš should show before/after markers
    toJSON
      âˆš should generate valid JSON (2 ms)
      âˆš should include summary in JSON output

PASS tests/elements/ComplexField.test.ts
  ComplexField
    Constructor and Basic Properties
      âˆš should create a complex field with instruction (4 ms)
      âˆš should create a complex field with instruction and result (1 ms)
      âˆš should support method chaining for setters (1 ms)
    XML Generation Structure
      âˆš should generate correct begin/separate/end structure (3 ms)
      âˆš should generate 4 runs when result is not provided (1 ms)
      âˆš should preserve xml:space attribute on instrText and result
    Formatting Support
      âˆš should apply instruction formatting (5 ms)
      âˆš should apply result formatting (1 ms)
      âˆš should support all formatting options (3 ms)
    XML Output Validation
      âˆš should generate valid XML that can be serialized (5 ms)
      âˆš should escape special characters in instruction and result (1 ms)
  createTOCField
    Default Options
      âˆš should create TOC with default options
      âˆš should enable hyperlinks by default
      âˆš should enable hideInWebLayout by default (1 ms)
      âˆš should enable useOutlineLevels by default (5 ms)
    Custom Levels
      âˆš should support custom heading levels (1 ms)
      âˆš should support single level
      âˆš should support non-sequential levels (1 ms)
    Switch Options
      âˆš should disable hyperlinks when requested
      âˆš should disable hideInWebLayout when requested (1 ms)
      âˆš should disable useOutlineLevels when requested
      âˆš should add omitPageNumbers switch
      âˆš should add customStyles switch (1 ms)
    Combined Options
      âˆš should support multiple options combined (1 ms)
      âˆš should support all options
    Instruction Format
      âˆš should have correct instruction format (1 ms)
      âˆš should maintain switch order (1 ms)
    Integration with ComplexField
      âˆš should return a ComplexField instance
      âˆš should generate valid XML structure (2 ms)
      âˆš should allow formatting to be applied after creation (3 ms)

PASS tests/utils/RevisionWalker.test.ts
  RevisionWalker
    processTree
      Unwrapping insertions (w:ins)
        âˆš should unwrap simple w:ins with one w:r child (1 ms)
        âˆš should unwrap w:ins with multiple w:r children (1 ms)
        âˆš should handle nested w:ins elements (1 ms)
        âˆš should preserve existing runs when unwrapping w:ins (2 ms)
        âˆš should not unwrap w:ins when acceptInsertions is false
      Removing deletions (w:del)
        âˆš should remove simple w:del with content (1 ms)
        âˆš should preserve sibling runs when removing w:del (1 ms)
        âˆš should not remove w:del when acceptDeletions is false
      Move operations (w:moveFrom, w:moveTo)
        âˆš should remove w:moveFrom with content (1 ms)
        âˆš should unwrap w:moveTo keeping content
        âˆš should not process moves when acceptMoves is false (1 ms)
      Property changes
        âˆš should remove w:rPrChange
        âˆš should remove w:pPrChange (1 ms)
        âˆš should remove all property change types (1 ms)
        âˆš should not remove property changes when acceptPropertyChanges is false
      Range markers
        âˆš should remove move range markers (1 ms)
        âˆš should remove all range marker types (2 ms)
      Element order preservation
        âˆš should update _orderedChildren when unwrapping
        âˆš should update _orderedChildren when removing (1 ms)
      Edge cases
        âˆš should handle empty w:ins elements
        âˆš should handle empty w:del elements
        âˆš should handle w:ins containing w:del (1 ms)
        âˆš should not mutate the original object
        âˆš should handle deeply nested structures
        âˆš should handle multiple w:ins elements at same level (1 ms)
      Integration with XMLParser
        âˆš should process parsed XML correctly (2 ms)
        âˆš should handle complex real-world XML (2 ms)
    isRevisionElement
      âˆš should identify w:ins as revision element
      âˆš should identify w:del as revision element
      âˆš should identify property changes as revision elements (1 ms)
      âˆš should identify range markers as revision elements
      âˆš should not identify regular elements as revision elements
    getRevisionElementCategories
      âˆš should return all revision element categories (20 ms)

PASS tests/utils/corruptionDetection.test.ts
  CorruptionDetection
    detectCorruptionInText
      âˆš should detect escaped XML tags (1 ms)
      âˆš should detect raw XML tags
      âˆš should detect XML entities in suspicious patterns (1 ms)
      âˆš should detect mixed corruption types
      âˆš should not flag clean text (1 ms)
      âˆš should handle empty or null input
    suggestFix
      âˆš should clean escaped XML tags (1 ms)
      âˆš should clean raw XML tags
      âˆš should clean mixed corruption
      âˆš should handle multiple XML patterns
      âˆš should clean up extra whitespace
      âˆš should handle already clean text
      âˆš should handle empty or null input
    looksCorrupted
      âˆš should quickly detect obvious corruption
      âˆš should not flag clean text (1 ms)
      âˆš should handle empty or null input
    detectCorruptionInDocument
      âˆš should detect corruption in a document (9 ms)
      âˆš should provide correct location information (1 ms)
      âˆš should not flag clean documents (1 ms)
      âˆš should generate helpful summary (2 ms)
      âˆš should handle empty documents (2 ms)
      âˆš should track statistics correctly (1 ms)
      âˆš should provide suggested fixes for each location (3 ms)
    Real-world corruption patterns
      âˆš should detect the exact pattern from the bug report (1 ms)
      âˆš should handle all patterns from the bug report (2 ms)

PASS tests/elements/Revision.test.ts
  Revision
    Basic Creation
      âˆš should create an insertion revision (3 ms)
      âˆš should create a deletion revision
      âˆš should create revision from text (1 ms)
      âˆš should create revision with custom date
      âˆš should default to current date if not provided
    Property Change Revisions
      âˆš should create run properties change revision (1 ms)
      âˆš should create paragraph properties change revision
      âˆš should create table properties change revision
      âˆš should create table exception properties change revision (1 ms)
      âˆš should create numbering change revision
    Move Operations
      âˆš should create moveFrom revision with move ID (1 ms)
      âˆš should create moveTo revision with move ID
      âˆš should link moveFrom and moveTo with same move ID (1 ms)
    Table Cell Operations
      âˆš should create table cell insert revision
      âˆš should create table cell delete revision
      âˆš should create table cell merge revision (1 ms)
    Multiple Runs
      âˆš should accept array of runs for insertion
      âˆš should add runs incrementally
    Author and Date Modification
      âˆš should allow setting author (1 ms)
      âˆš should allow setting date
      âˆš should support method chaining
    Location Tracking
      âˆš should set and get revision location (1 ms)
      âˆš should support all location fields
    Field Instruction Handling
      âˆš should create field instruction deletion (1 ms)
      âˆš should mark revision as field instruction
    XML Generation
      âˆš should generate valid XML for insertion (1 ms)
      âˆš should generate valid XML for deletion
      âˆš should include move ID in move revisions (1 ms)
      âˆš should generate correct element names for all types (3 ms)
      âˆš should generate previous properties for property change revisions (1 ms)
      âˆš should format date as ISO 8601
      âˆš should return null for internal tracking types (1 ms)
    Content Access
      âˆš should return defensive copy of content
      âˆš should return defensive copy of runs (1 ms)
    ID Management
      âˆš should start with default ID of 0
      âˆš should allow setting ID
    Internal Tracking Types
      âˆš should allow creating internal tracking type revisions for metadata purposes (1 ms)

PASS tests/elements/FieldHyperlink.test.ts
  HYPERLINK Field Instruction Parsing
    parseHyperlinkInstruction
      âˆš should parse basic HYPERLINK instruction (12 ms)
      âˆš should parse HYPERLINK with \l anchor switch (2 ms)
      âˆš should parse anchor-only HYPERLINK (no URL) (1 ms)
      âˆš should parse anchor-only HYPERLINK with extra spaces
      âˆš should parse HYPERLINK with \o tooltip switch (1 ms)
      âˆš should parse HYPERLINK with all switches (1 ms)
      âˆš should detect \h switch at end of instruction
      âˆš should detect missing \h switch (1 ms)
      âˆš should decode URL-encoded characters (1 ms)
      âˆš should decode %23 (hash) in URL (1 ms)
      âˆš should decode anchor value as well (1 ms)
      âˆš should handle URL with existing fragment and anchor switch
      âˆš should return null for non-HYPERLINK instructions (1 ms)
      âˆš should return null for empty or null input
      âˆš should return null for HYPERLINK without URL (1 ms)
      âˆš should preserve raw instruction
      âˆš should handle case-insensitive HYPERLINK keyword (1 ms)
      âˆš should handle URLs with query parameters (1 ms)
    buildHyperlinkInstruction
      âˆš should build basic HYPERLINK instruction
      âˆš should build HYPERLINK with anchor (1 ms)
      âˆš should build HYPERLINK with tooltip
      âˆš should build HYPERLINK with all options
    isHyperlinkInstruction
      âˆš should return true for HYPERLINK instructions (1 ms)
      âˆš should return false for non-HYPERLINK instructions (7 ms)
      âˆš should return false for empty/null input (1 ms)
    ComplexField HYPERLINK integration
      âˆš should auto-parse HYPERLINK instruction in ComplexField
      âˆš should not auto-parse non-HYPERLINK instruction (1 ms)
      âˆš should decode URL-encoded characters in ComplexField
      âˆš should handle HYPERLINK with base URL and \l anchor (1 ms)

PASS tests/ms-doc/cfb/CFBReader.test.ts
  CFBReader
    isValidCFB
      âˆš should return true for valid CFB signature (2 ms)
      âˆš should return false for invalid signature
      âˆš should return false for data too short (1 ms)
      âˆš should work with ArrayBuffer input
      âˆš should work with Buffer input (1 ms)
    parse
      âˆš should throw CFBParseError for file too small (44 ms)
      âˆš should throw CFBParseError for invalid signature (1 ms)
      âˆš should throw CFBParseError for unsupported version (1 ms)
      âˆš should throw CFBParseError for wrong byte order (2 ms)
    header parsing
      âˆš should correctly parse version 3 header (6 ms)
      âˆš should correctly parse signature (1 ms)
    directory entries
      âˆš should find root storage entry (1 ms)
      âˆš should parse all directory entries
    stream access
      âˆš should return null for non-existent stream (1 ms)
      âˆš should report correct stream names
      âˆš should report correct storage names (1 ms)
      âˆš should correctly check stream existence (1 ms)
    FAT chain following
      âˆš should correctly build FAT
    integration with real .doc files
      â—‹ skipped should parse a real .doc file

PASS tests/elements/BookmarkManager.test.ts
  BookmarkManager
    Basic Operations
      âˆš should create empty manager (1 ms)
      âˆš should register bookmarks and assign unique IDs
      âˆš should throw on duplicate bookmark names (14 ms)
      âˆš should clear all bookmarks
    getUniqueName
      âˆš should return base name if not taken (1 ms)
      âˆš should add suffix if name is taken
      âˆš should increment suffix until unique (1 ms)
      âˆš should truncate long names to fit 40-char limit with suffix
      âˆš should handle multiple duplicates with long names (1 ms)
      âˆš should handle larger suffix numbers (1 ms)
    createHeadingBookmark
      âˆš should create bookmark from heading text (1 ms)
      âˆš should handle multiple headings with same prefix (1 ms)
      âˆš should handle many similar long headings (2 ms)
    getStats
      âˆš should return correct statistics

PASS tests/xml/XMLBuilder-sanitization.test.ts
  XML Sanitization
    removeInvalidXmlChars
      âˆš should remove NULL byte (0x00) (3 ms)
      âˆš should remove all invalid control chars (0x00-0x08) (1 ms)
      âˆš should preserve TAB (0x09) (1 ms)
      âˆš should preserve newline (0x0A) (1 ms)
      âˆš should remove VERTICAL TAB (0x0B) (3 ms)
      âˆš should remove FORM FEED (0x0C) (1 ms)
      âˆš should preserve carriage return (0x0D)
      âˆš should remove control chars (0x0E-0x1F) (1 ms)
      âˆš should remove DELETE (0x7F)
      âˆš should handle empty string (1 ms)
      âˆš should handle string with only invalid chars
      âˆš should preserve normal text unchanged (1 ms)
      âˆš should preserve Unicode characters
      âˆš should preserve emoji (1 ms)
      âˆš should handle mixed valid and invalid characters
    findInvalidXmlChars
      âˆš should return empty array for valid text (1 ms)
      âˆš should find NULL byte (1 ms)
      âˆš should find multiple invalid chars (1 ms)
      âˆš should return unique codes only
      âˆš should not include valid control chars (tab, newline, CR)
    hasInvalidXmlChars
      âˆš should return false for valid text
      âˆš should return true for text with NULL (1 ms)
      âˆš should return false for valid control chars
      âˆš should return true for DELETE char
    XML_CONTROL_CHARS constants
      âˆš should have correct values for valid chars
      âˆš should have correct values for invalid chars
    XMLBuilder.escapeXmlText
      âˆš should escape & < > characters (1 ms)
      âˆš should NOT escape quotes (text content, not attributes) (1 ms)
      âˆš should remove NULL byte before escaping
      âˆš should preserve tab and newline
      âˆš should remove DELETE char (1 ms)
      âˆš should handle complex mixed content
    XMLBuilder.escapeXmlAttribute
      âˆš should escape all XML special chars including quotes
      âˆš should escape single quotes
      âˆš should remove NULL byte before escaping
      âˆš should remove control chars
    XMLBuilder.sanitizeXmlContent
      âˆš should remove control chars and escape XML (1 ms)
      âˆš should escape CDATA end marker (2 ms)
      âˆš should preserve valid control chars (1 ms)
    Integration: Document round-trip with control chars
      âˆš should produce valid XML when text contains control chars (1 ms)
      âˆš should produce valid XML in attributes

PASS tests/core/HyperlinkMerging.test.ts
  Hyperlink Merging Behavior
    consecutive hyperlinks with same URL
      âˆš should merge truly consecutive hyperlinks with same URL (2 ms)
      âˆš should NOT merge non-consecutive hyperlinks with same URL (1 ms)
      âˆš should preserve text position between non-consecutive hyperlinks (1 ms)
      âˆš should handle multiple different URLs correctly (2 ms)
    paragraph getText() with mixed content
      âˆš should concatenate text correctly from mixed hyperlinks and runs
      âˆš should preserve exact text when same URL appears multiple times (1 ms)

PASS tests/utils/cnfStyleDecoder.test.ts
  cnfStyleDecoder
    decodeCnfStyle
      âˆš should decode firstRow flag from position 0 (2 ms)
      âˆš should decode lastRow flag from position 1 (1 ms)
      âˆš should decode firstCol flag from position 2
      âˆš should decode lastCol flag from position 3
      âˆš should decode banding flags from positions 4-7
      âˆš should decode corner cell flags from positions 8-11 (1 ms)
      âˆš should decode multiple flags at once
      âˆš should decode first row + nwCell (top-left corner)
      âˆš should handle short strings by padding with zeros (1 ms)
      âˆš should handle empty string
      âˆš should return all false for all zeros
      âˆš should return all true for all ones
    encodeCnfStyle
      âˆš should encode firstRow flag
      âˆš should encode multiple flags (1 ms)
      âˆš should encode corner cells
      âˆš should encode banding flags
      âˆš should return all zeros for empty object (1 ms)
      âˆš should round-trip encode/decode
    getActiveConditionals
      âˆš should return empty array for no active conditionals
      âˆš should return firstRow for 100000000000
      âˆš should return multiple conditionals (1 ms)
      âˆš should return corner cells correctly
    getActiveConditionalsInPriorityOrder
      âˆš should return conditionals in priority order (corners first) (1 ms)
      âˆš should order edges before banding
      âˆš should match CONDITIONAL_PRIORITY_ORDER (1 ms)
    CNF_TO_CONDITIONAL_MAP
      âˆš should map all flags to valid ConditionalFormattingType values (1 ms)

PASS tests/utils/parsingHelpers.test.ts
  parsingHelpers
    safeParseInt
      âˆš should parse valid integer strings (2 ms)
      âˆš should handle numeric input
      âˆš should return default for undefined/null (1 ms)
      âˆš should return default for invalid strings
      âˆš should return default for NaN input (1 ms)
      âˆš should handle zero correctly (not as falsy) (1 ms)
    parseOoxmlBoolean
      âˆš should return false for absent element (1 ms)
      âˆš should return true for self-closing element without w:val
      âˆš should return true for explicit true values (1 ms)
      âˆš should return false for explicit false values
      âˆš should handle case variations (1 ms)
    isExplicitlySet
      âˆš should return true for explicitly set values (1 ms)
      âˆš should return false for undefined/null
      âˆš should correctly handle zero (the main fix)
    parseNumericAttribute
      âˆš should parse valid values
      âˆš should return default for undefined/null (1 ms)
      âˆš should return default for invalid values
      âˆš should preserve zero values
    parseOnOffAttribute
      âˆš should return true for on values (2 ms)
      âˆš should return false for off values (1 ms)
      âˆš should return default for undefined/null

PASS tests/core/NestedTablePreservation.test.ts
  NestedTablePreservation
    TableCell raw nested content
      âˆš should store and retrieve raw nested content (2 ms)
      âˆš should update raw nested content
      âˆš should return false when updating invalid index
      âˆš should clear raw nested content (1 ms)
      âˆš should handle SDT content type
    TableCell toXML with nested content
      âˆš should include nested table in XML output
      âˆš should preserve multiple nested tables at different positions (1 ms)
      âˆš should handle cell with only nested table and no paragraphs
    Document load/save with nested tables
      âˆš should preserve nested tables when loading and saving
    Deep nesting scenarios
      âˆš should preserve 5 levels of nested tables (1 ms)
      âˆš should handle nested tables with revision markers
      âˆš should handle multiple nested tables at different positions in same cell
      âˆš should handle nested SDT containing nested table
      âˆš should handle large nested table structures without performance degradation
    Edge cases
      âˆš should handle nested table with minimal valid structure
      âˆš should handle nested table with merged cells (gridSpan and vMerge) (1 ms)
      âˆš should handle nested table with complex borders and shading
      âˆš should handle nested table with hyperlinks and bookmarks (1 ms)
      âˆš should handle empty cell with only nested content

Test Suites: 86 passed, 86 total
Tests:       1 skipped, 1986 passed, 1987 total
Snapshots:   0 total
Time:        19.066 s
Ran all test suites.
